{"version":3,"sources":["pantonePalette.ts","utils.js","../../tfl-api-wrapper/lib/enums/trackerNet/lines.ts","constants.ts","tfl_roundel_no_text.svg","../../tfl-api-wrapper/lib/tfl.ts","../../tfl-api-wrapper/lib/line.ts","../../tfl-api-wrapper/lib/stopPoint.ts","../../tfl-api-wrapper/lib/enums/trackerNet/stations.ts","../../tfl-api-wrapper/lib/enums/modes.ts","api.ts","components/Map/MapContext.jsx","properties.jsx","components/Map/Map.jsx","components/Graphs.tsx","components/CheckBoxTreeView.tsx","components/ModeCheckList.tsx","components/App/App.tsx","theme.ts","reportWebVitals.js","index.jsx"],"names":["pantone","require","pantonePalette","forEach","name","r","g","b","Color","rgb","map","ch","hex","deg2rad","deg","Math","PI","TrackerNetLines","getDistanceFromLatLonInKm","loc1","loc2","lat1","lon1","lat2","lon2","dLat","dLon","a","sin","cos","atan2","sqrt","getUniqueListBy","arr","key","Map","item","values","mapArrayOfKeysToObject","fn","Object","fromEntries","k","objectMap","obj","entries","i","v","objectFilter","filter","setUnion","Set","roundAccurately","number","decimalPlaces","Number","round","setNestedObject","base","names","value","split","lastName","arguments","length","pop","catchHttpError","alert","response","data","status","MODES_INFO_ALL","bus","label","color","selectedByDefault","icon","hidden","coach","dlr","overground","tflrail","tram","tube","MODES_INFO","MODES_DEFAULT","LONDON_UNDERGROUND_LINE_COLORS","bakerloo","central","circle","piccadilly","district","victoria","jubilee","metropolitan","northern","Black","LINE_COLORS","c2c","merseyrail","scotrail","southeastern","southern","thameslink","TFL_API_URL_ROOT","NAPTAN_STOPTYPES","TfLAPI","appKey","host","port","this","uri","params","method","FullURL","keys","undefined","qs","axios","get","headers","Accept","fetch","reTag","xmlData","retag","trackerNetRetag","jsonObj","xmlparser","attributeNamePrefix","ignoreAttributes","join","oldDate","toISOString","incidentsOnly","Line","config","sendRequest","line","modes","arrayToCSV","lines","detail","startDate","endDate","convertDate","severityLevel","from","to","NaPTANID","direction","ids","NaptanID","destinationStationId","serviceTypes","StopPoint","includeCrowdingData","types","id","lineIds","getFamily","includeRouteBlockedStops","flattenResponse","lineID","stopTypes","radius","useStopPointHierarchy","categories","returnLines","latitude","longitude","lat","lon","smsID","output","TrackerNetStations","getLatLonFromPostCode","postcode","postcodes","lookup","res","result","getPostCodeFromLatLon","latLon","geo","limit","stopPointInstance","StopPointFunctions","process","lineInstance","LineFunctions","getModes","getLinesByModes","modeNames","getAllByModes","getlineModeDictionary","lineModeDictionary","modeName","modeId","lineId","lineName","console","warn","makeTFLGetRequest","route","otherParams","app_key","paramsString","URLSearchParams","toString","ok","json","exceptionType","httpStatusCode","httpStatus","message","error","getStopPointsByRadius","latLong","getInRadius","stopPoints","getRoutesOnLine","routeSequence","lineStrings","lineString","JSON","parse","filterStopPoints","chosenModesSet","topLevelKey","origin","Array","x","has","size","Promise","all","stopPoint","getByIDs","distance","defaultFilterData","MapContext","createContext","MapProvider","children","useState","filterData","setFilterData","Provider","useMemo","outcodeData","getOnthemarketLink","useContext","toLowerCase","replace","getOpenrentLink","getZooplaLink","getRightmoveLink","codedOutcode","outcode","jsonInfo","find","code","PropertyLink","href","target","rel","OnthemarketLink","OpenrentLink","RightmoveLink","ZooplaLink","TileLayerDefault","attribution","TileLayer","url","TileLayerCustom","styleId","MapTileLayer","useCustomMap","setUseCustomMap","useEffect","originMarker","L","ExtraMarkers","markerColor","shape","prefix","SetView","useMap","setView","getZoom","animate","formatLineModes","lineModes","s","mode","MapOriginMarkers","originInfo","Marker","position","Popup","stringify","Circle","center","MapLines","mapLineSegments","seg","segmentWidth","Fragment","j","Polyline","opacity","positions","lineCoords","offset","lineWeight","weight","MapStation","station","setPostcode","_postcode","coords","CircleMarker","fillColor","fillOpacity","eventHandlers","click","style","whiteSpace","zone","MapStations","stations","graphSerialized","nearbyStopPoints","setMapLineSegments","setStations","_displayedGraph","Graph","multi","import","_mapLineSegments","forEachEdge","edge","fromNode","toNode","fromTo","sort","getNodeAttributes","fromLat","fromLon","toLat","toLon","push","lmd","_stations","forEachNode","attributes","rest","info","MapContainer","zoom","scrollWheelZoom","mergeGraph","inputGraph","outputGraph","setAttributes","node","setName","currentAttribute","hasNode","getNodeAttribute","incomingAttribute","newAttribute","mergeNode","mergeEdgeWithKey","mergeGraphObject","graphObject","isMulti","some","graph","getLineGraphFromLine","branchDataKey","lineGraph","stopPointSequences","toast","lineColor","stopPointSequence","stopPointArray","spFrom","spTo","y","type","makeLineGraphUndirected","edgeJson","getLineGraphObjectFromLineIdList","lineIdList","directionList","reverseGraph","lineGraphObject","reverse","getAllChild","childNode","collectedNodes","isArray","goThroughAllNodes","nodes","splice","getNodeById","parentsPath","getChildById","path","childNodesToToggle","stateGetter","stateSetter","defaultExpanded","selectedSet","React","parentMap","TreeView","defaultExpandIcon","defaultCollapseIcon","textAlign","renderTree","allSelectedChildren","every","childNodeId","checked","indeterminate","TreeItem","nodeId","FormControlLabel","control","Checkbox","onChange","event","array","includes","indexOf","getOnChange","currentTarget","onClick","e","stopPropagation","ModeCheckList","setData","modeLineTree","isScheduledService","isFarePaying","isTflService","chosenByDefault","child","grandchildren","CheckBoxTreeView","mergeStopPoint","handleKeyDown","form","element","elements","localName","focus","preventDefault","blur","TextInputCustom","dataObject","handleFormChange","TextField","variant","defaultValue","onBlur","onKeyDown","NumInputCustom","handleNumChange","adornment","float","InputProps","InputAdornment","text","App","setInfo","isBusy","setBusy","setDisplayedGraph","setOriginInfo","setNearbyStopPoints","setGraphSerialized","getModeCheckList","setModeCheckList","defaultFormData","formData","setFormData","urlParams","window","location","search","_formData","_filterData","cnd","setFn","allowFloat","pattern","onlyInts","updateUrl","queryString","history","pushState","handleButtonClick","toastId","_info","loading","success","summary","commonName","summaryText","nearbyLineIdList","nearbyStopPointsOnLines","lineModeGroups","lineIdentifier","directions","finalGraphOutward","finalGraphDirections","lineGraphObjectInDirection","stopPointsReachableFromNearbyStopPointsOnLineGraph","graphDirectionLine","stationNaptan","dfsFromNode","attr","sub","subgraph","finalGraphMerged","copy","export","SearchButton","useCallback","Button","disabled","Container","maxWidth","className","Paper","src","logo","alt","Typography","component","gutterBottom","Grid","container","elevation","sx","m","width","alignItems","xs","sm","onSubmit","fontSize","theme","createTheme","palette","primary","main","light","dark","secondary","red","A400","background","default","components","MuiPaper","styleOverrides","root","padding","margin","MuiButton","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","ThemeProvider","CssBaseline","document","getElementById"],"mappings":"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AAA,E,gBAAAA,E,eAAAA,E,iBAAAA,E,kBAAAA,E,gBAAAA,E,qBAAAA,E,mBAAAA,E,oBAAAA,E,aAAAA,E,iBAAAA,E,oBAAAA,E,kBAAAA,E,kBAAAA,E,sBAAAA,E,oBAAAA,E,cAAAA,E,qBAAAA,E,iBAAAA,E,wBAAAA,E,gBAAAA,E,iBAAAA,E,cAAAA,E,kBAAAA,E,eAAAA,E,YAAAA,E,cAAAA,E,cAAAA,E,aAAAA,E,eAAAA,E,mBAAAA,E,kBAAAA,E,kBAAAA,E,iBAAAA,E,gBAAAA,E,iBAAAA,E,kBAAAA,E,oBAAAA,E,qBAAAA,E,cAAAA,E,kBAAAA,E,mBAAAA,E,WAAAA,E,cAAAA,E,kBAAAA,E,kBAAAA,E,cAAAA,E,kBAAAA,E,iBAAAA,E,eAAAA,E,cAAAA,E,kBAAAA,E,gBAAAA,E,eAAAA,E,mBAAAA,E,mBAAAA,E,mBAAAA,E,kBAAAA,E,gBAAAA,E,mBAAAA,E,oBAAAA,E,iBAAAA,E,mBAAAA,E,mBAAAA,E,qBAAAA,E,mBAAAA,E,iBAAAA,E,kBAAAA,E,kBAAAA,E,mBAAAA,E,aAAAA,E,mBAAAA,E,uBAAAA,E,iBAAAA,E,gBAAAA,E,qBAAAA,E,mBAAAA,E,iBAAAA,E,cAAAA,E,mBAAAA,E,eAAAA,E,wBAAAA,E,iBAAAA,E,cAAAA,E,aAAAA,E,iBAAAA,E,oBAAAA,E,mBAAAA,E,eAAAA,E,aAAAA,E,iBAAAA,E,qBAAAA,E,cAAAA,E,mBAAAA,E,mBAAAA,E,sBAAAA,E,gBAAAA,E,mBAAAA,E,gBAAAA,E,gBAAAA,E,0BAAAA,E,qBAAAA,E,iBAAAA,E,mBAAAA,E,kBAAAA,E,eAAAA,E,iBAAAA,E,2BAAAA,E,iBAAAA,E,iBAAAA,E,eAAAA,E,iBAAAA,E,iCAAAA,E,gBAAAA,E,kBAAAA,E,sBAAAA,E,oBAAAA,E,mBAAAA,E,mBAAAA,E,cAAAA,E,qBAAAA,E,kBAAAA,E,2BAAAA,E,mBAAAA,E,wBAAAA,E,2BAAAA,E,wBAAAA,E,kBAAAA,E,eAAAA,E,gBAAAA,E,iBAAAA,E,iBAAAA,E,cAAAA,E,oBAAAA,E,kBAAAA,E,0BAAAA,E,oBAAAA,E,aAAAA,E,mBAAAA,E,sBAAAA,E,sBAAAA,E,eAAAA,E,kBAAAA,E,mBAAAA,E,iBAAAA,E,yBAAAA,E,eAAAA,E,mBAAAA,E,cAAAA,E,iBAAAA,E,eAAAA,E,aAAAA,E,iBAAAA,E,cAAAA,E,kBAAAA,E,kBAAAA,E,kBAAAA,E,qBAAAA,E,sBAAAA,E,eAAAA,E,cAAAA,E,gBAAAA,E,wBAAAA,E,cAAAA,E,eAAAA,E,WAAAA,E,mBAAAA,E,iBAAAA,E,eAAAA,E,mBAAAA,E,uBAAAA,E,cAAAA,E,eAAAA,E,gBAAAA,E,mBAAAA,E,iBAAAA,E,gBAAAA,E,sBAAAA,E,gBAAAA,E,kBAAAA,E,eAAAA,E,mBAAAA,E,oBAAAA,E,qBAAAA,E,cAAAA,E,mBAAAA,E,oBAAAA,E,kBAAAA,E,gBAAAA,E,kBAAAA,E,gBAAAA,E,kBAAAA,E,kBAAAA,E,kBAAAA,E,kBAAAA,E,sBAAAA,E,kBAAAA,E,mBAAAA,E,mBAAAA,E,eAAAA,E,oBAAAA,E,mBAAAA,E,gBAAAA,E,kBAAAA,E,cAAAA,E,mBAAAA,E,mBAAAA,E,oBAAAA,E,gBAAAA,E,qBAAAA,E,iBAAAA,E,sBAAAA,E,yBAAAA,E,aAAAA,E,mBAAAA,E,kBAAAA,E,gBAAAA,E,6BAAAA,E,kBAAAA,E,mBAAAA,E,oBAAAA,E,sBAAAA,E,gBAAAA,E,gBAAAA,E,YAAAA,E,eAAAA,E,eAAAA,E,eAAAA,E,gBAAAA,E,yBAAAA,E,eAAAA,E,mBAAAA,E,kBAAAA,E,gBAAAA,E,gBAAAA,E,eAAAA,E,mBAAAA,E,gBAAAA,E,oBAAAA,E,cAAAA,E,qBAAAA,E,qBAAAA,E,eAAAA,E,oBAAAA,E,kBAAAA,E,kBAAAA,E,kBAAAA,E,mBAAAA,E,oBAAAA,Q,KAuQIA,ICvQJpC,kB,eAAAA,G,qBAAAA,G,cAAAA,G,uBAAAA,G,UAAAA,G,kDAAAA,G,uCAAAA,G,6BAAAA,G,wBAAAA,G,iCAAAA,G,qBAAAA,G,uBAAAA,G,YAAAA,G,kBAAAA,G,YAAAA,G,YAAAA,G,kBAoBIA,I,oBCIFqC,GAAqB,uCAAG,WACnCC,GADmC,iBAAAtJ,EAAA,sEAGPuJ,KAAUC,OAAOF,GAHV,qBAGrBG,EAHqB,EAG7BC,QAH6B,uBAKjCD,EAAMzI,EAAUyI,GAAK,SAACrI,GAAD,OAAeK,EAAgBL,EAAG,MALtB,kBAM1B,CAACqI,EAAIX,SAAUW,EAAIV,YANO,2CAAH,sDAUrBY,GAAqB,uCAAG,WACnCC,GADmC,iBAAA5J,EAAA,sEAGPuJ,KAAUM,IAAV,MAAAN,KAAS,YAAQK,GAAR,QAAgB,CAACE,MAAO,QAH1B,qBAGrBL,EAHqB,EAG7BC,QAH6B,yCAK1BD,EAAI,GAAGH,UALmB,2CAAH,sDAU5BS,GAAoB,IAAIC,GADIC,oCAE5BC,GAAe,IAAIC,GAFSF,oCAIrBG,GAAW,kBAAMF,GAAaE,YAC9BC,GAAkB,SAACC,GAAD,OAC7BJ,GAAaK,cAAcD,IAKvBE,GAAqB,uCAAG,gDAAAxK,EAAA,6DACtByK,EAAqB,GADC,SAERL,KAFQ,cAEtBpD,EAFsB,OAK5BsD,GAFIA,EAAYtD,EAAMjI,KAAI,qBAAG2L,aAEPpJ,QAAO,SAACoJ,GAAD,MAA2B,mBAAbA,KALf,SAMRL,GAAgBC,GANR,OAMtBpD,EANsB,qBAOTA,GAPS,IAO5B,2BAAWH,EAAe,QACN4D,EAAuC5D,EAAjD2D,SAAsBE,EAA2B7D,EAA/BoB,GAAkB0C,EAAa9D,EAAnBtI,KAChCiM,EAAW9H,EAAe+H,GAAQ7H,MAEtC8H,KAAUH,GACVA,EAAmBG,KAAYD,EAE/BG,QAAQC,KAAR,eAAqBH,EAArB,wCAA2DD,IAE3DF,EAAmBG,GAAU,CAACA,SAAQC,WAAUF,SAAQD,YAhBhC,uDAmBrBD,GAnBqB,4CAAH,qDAsBdA,GAAqBD,KAErBQ,GAAiB,uCAAG,WAC/BC,EACAC,GAF+B,+BAAAlL,EAAA,6DAIzBgF,EAvC0BiF,mCAwC1B5E,EAAe,aACf8F,QAASnG,GAAWkG,GAEpBE,EAAe,IAAIC,gBAAgBhG,GAAQiG,WARlB,SAURvF,MAAM,GAAD,OAAIlB,GAAJ,OAAuBoG,EAAvB,YAAgCG,IAV7B,YAUzB3I,EAVyB,QAWlB8I,GAXkB,yCAYtB9I,EAAS+I,QAZa,wBAevB/I,EAAS+I,OAfc,wBAcvBC,EAduB,EAcvBA,cAAeC,EAdQ,EAcRA,eAAgBC,EAdR,EAcQA,WAAYC,EAdpB,EAcoBA,QAEnDd,QAAQe,MAAR,UACKJ,EADL,aACuBC,EADvB,aAC0CC,EAD1C,cAC0DC,EAD1D,kBAC2E/G,GAD3E,OAC8FoG,EAD9F,MAhB+B,kBAmBxB,MAnBwB,4CAAH,wDAsBjBa,GAAqB,uCAAG,WACnCrD,EACAsD,EACArD,GAHmC,qBAAA1I,EAAA,2EAKhB+L,EALgB,GAK5B/C,EAL4B,KAKvBC,EALuB,cAOjBc,GAAkBiC,YAClCvD,EACAC,GACA,EACA,GACA,IACA,EACAM,EACAC,GAfiC,UA2BhB,qBApBbQ,EAP6B,iDA2BIA,EAAIwC,YA3BR,gCA4B5B,IA5B4B,2CAAH,0DAqCrBC,GAAe,uCAAG,WAAOtB,GAAP,eAAA5K,EAAA,sEACDgL,GAAkB,SAAD,OAClCJ,EADkC,wBADhB,UAIP,QAHhBuB,EADuB,iDAIM,MAJN,cAK7BA,EAAcC,YAAcD,EAAcC,YAAYrN,KACpD,SAACsN,GAAD,OAAwBC,KAAKC,MAAMF,GAAY,MANpB,kBAQtBF,GARsB,2CAAH,sDA0BfK,GAAgB,uCAAG,WAC9BP,EACAQ,EACAC,EACAC,GAJ8B,SAAA3M,EAAA,yDAO9BiM,EAAaA,EAAW3K,QACtB,gBAAG4F,EAAH,EAAGA,MAAH,OAAoB,OAALA,QAAK,IAALA,OAAA,EAAAA,EAAO7E,SAAU6E,EAAM7E,OAAS,KAInB,qBAAnBoK,IACTR,EAAaA,EAAW3K,QACtB,gBTnG0BtB,EAAGpB,ESmG1BoI,EAAH,EAAGA,MAAH,OTnG0BhH,ESmGK,IAAIwB,IAAIwF,GTnGVpI,ESmGkB6N,ETnGZ,IAAIjL,IAC3CoL,MAAMpF,KAAKxH,GAAGsB,QAAO,SAAAuL,GAAC,OAAIjO,EAAEkO,IAAID,QSkGmCE,KAAO,MAK/C,qBAAhBL,EAnBmB,yCAoBrBT,GApBqB,uBAuBXe,QAAQC,IACzBhB,EAAWlN,IAAX,uCACE,WAAOmO,GAAP,SAAAlN,EAAA,sEAES+J,GAAkBoD,SAAS,CAChCD,EAAUR,KAHd,mFADF,wDAxB4B,cAgC9BT,GATAA,EAvB8B,QAgCNlN,KAAI,SAACmO,GAAD,mBAAC,eACxBA,GADuB,IAE1BE,SAAWT,EAEPpN,EAA0BoN,EAAQ,CAACO,EAAUlE,IAAKkE,EAAUjE,OAD3D,OAnCuB,kBAsCvB5I,EAAgB4L,EAAYS,IAtCL,2CAAH,4D,QC3JhBW,GAAoB,CAC/B,eAPkC,EAQlC,eAPkC,EAQlC,YAN+B,KAO/B,cANuC,IAS5BC,GAAaC,0BAEbC,GAAc,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAC5B,EAAoCC,mBAASL,IAA7C,mBAAOM,EAAP,KAAmBC,EAAnB,KACA,OACE,eAACN,GAAWO,SAAZ,CAAqB5L,MAAO6L,mBAAQ,iBAAO,CAAEH,aAAYC,oBAAzD,SACGH,KCbDM,GAAczP,EAAQ,KAItB0P,GAAqB,SAAC,GAAkB,IAAhB1E,EAAe,EAAfA,SAE5B,IAAKA,EAAU,OAAO,KACtB,IAAQqE,EAAeM,qBAAWX,IAA1BK,WAQR,MANS,uDAAmDrE,EAAS4E,cAAcC,QAAQ,IAAK,KAAvF,+CACIR,EAAW,gBADf,uBAECA,EAAW,aAFZ,0BAGIA,EAAW,gBAHf,oBAIFA,EAAW,eAJT,eAMEQ,QAAQ,kBAAmB,MAGlCC,GAAkB,SAAC,GAAkB,IAAhB9E,EAAe,EAAfA,SAEzB,IAAKA,EAAU,OAAO,KACtB,IAAQqE,EAAeM,qBAAWX,IAA1BK,WASR,MAPS,8DAA0DrE,EAA1D,kBArBS,MAsBbqE,EAAW,eADP,wBAEEA,EAAW,aAFb,0BAGIA,EAAW,gBAHf,0BAIIA,EAAW,gBAJf,oCAOEQ,QAAQ,kBAAmB,MAGlCE,GAAgB,SAAC,GAAkB,IAAhB/E,EAAe,EAAfA,SAEvB,IAAKA,EAAU,OAAO,KACtB,IAAQqE,EAAeM,qBAAWX,IAA1BK,WAaR,MAZS,6CAAyCrE,EAAzC,sBACAqE,EAAW,gBADX,sBAEAA,EAAW,gBAFX,kDAICA,EAAW,aAJZ,6HAUFA,EAAW,eAVT,+BAYEQ,QAAQ,kBAAmB,MAGlCG,GAAmB,SAAC,GAAkB,IAAhBhF,EAAe,EAAfA,SAC1B,IAAKA,EACH,OAAO,KAET,IAIIiF,EAJEC,EAAUlF,EAASpH,MAAM,KAAK,GAC9BuM,EAAWV,GAAYW,MAC3B,qBAAGF,UAA2CA,KAGhD,IAAIC,EAGF,OAAO,KAFEF,EAAiBE,EAAvBE,KAKL,IAAQhB,EAAeM,qBAAWX,IAA1BK,WAqBR,MApBS,iHAEoBY,EAFpB,yCAKAZ,EAAW,aALX,yBAMGA,EAAW,gBANd,yBAOGA,EAAW,gBAPd,0QAoBEQ,QAAQ,kBAAmB,MAGlCS,GAAe,SAAC,GAAD,IAAGnB,EAAH,EAAGA,SAAUoB,EAAb,EAAaA,KAAb,OACnBA,GACE,qBAAGA,KAAMA,EAAMC,OAAO,SAASC,IAAI,sBAAnC,UACGtB,EACD,4BAIOuB,GAAkB,SAAC,GAAD,IAAG1F,EAAH,EAAGA,SAAH,OAC7B,eAAC,GAAD,CAAcuF,KAAMb,GAAmB,CAAE1E,aAAzC,0BAKW2F,GAAe,SAAC,GAAD,IAAG3F,EAAH,EAAGA,SAAH,OAC1B,eAAC,GAAD,CAAcuF,KAAMT,GAAgB,CAAE9E,aAAtC,wCAKW4F,GAAgB,SAAC,GAAD,IAAG5F,EAAH,EAAGA,SAAH,OAC3B,eAAC,GAAD,CAAcuF,KAAMP,GAAiB,CAAEhF,aAAvC,4CAKW6F,GAAa,SAAC,GAAD,IAAG7F,EAAH,EAAGA,SAAH,OACxB,eAAC,GAAD,CAAcuF,KAAMR,GAAc,CAAE/E,aAApC,qB,yBC/EFhL,EAAQ,KAER,IAAM8Q,GAAmB,SAAC,GAAD,IAAGC,EAAH,EAAGA,YAAH,OACvB,eAACC,GAAA,EAAD,CACED,YAAW,oGAEkFA,GAE7FE,IAAI,wDAIFC,GAAkB,SAAC,GAAD,QAAGC,eAAH,MAAa,eAAb,EAA6BJ,EAA7B,EAA6BA,YAA7B,OACtB,eAACC,GAAA,EAAD,CACED,YAAW,4KAE4JA,GAEvKE,IAAG,+BAA0BE,EAA1B,4CAAqExF,uEAItEyF,GAAe,WACnB,MAAwChC,wBAASjI,GAAjD,mBAAOkK,EAAP,KAAqBC,EAArB,KAIA,IAAMH,EAAUxF,uCAUhB,OARA4F,qBAAU,WACR,sBAAC,4BAAA7P,EAAA,sEACwB+F,MAAM,wBAAD,OACF0J,EADE,6CAC0CxF,qEAFvE,OACOxH,EADP,OAICmN,IAAkBnN,EAAS8I,IAJ5B,0CAAD,KAMC,SAEgB9F,IAAjBkK,IACCA,EACC,eAAC,GAAD,CAAiBF,QAASA,EAASJ,YAZnB,KAchB,eAAC,GAAD,CAAkBA,YAdF,OAmBhBS,GAAeC,KAAEC,aAAa/M,KAAK,CACvCA,KAAM,cACNgN,YAAa,OACbC,MAAO,SACPC,OAAQ,OAgCJC,GAAU,SAAC,GAAiB,IAAfrE,EAAc,EAAdA,QACXhN,EAAMsR,eAEZ,OADAtR,EAAIuR,QAAQvE,EAAShN,EAAIwR,UAAW,CAAEC,SAAS,IACxC,MAMHC,GAAkB,SAACC,GAEvB,IADA,IAAIC,EAAI,GACR,MAA4B9P,OAAOK,QAAQwP,GAA3C,eAAuD,CAAlD,0BAAOE,EAAP,KAAa1J,EAAb,KACHyJ,GAAC,iBAASC,EAAT,aADoD,oBAElC1J,GAFkC,IAErD,2BAA0B,CAAC,IAAhBH,EAAe,QACxB4J,GAAC,kBAAU5J,EAAV,OAHkD,+BAMvD,OAAO4J,GAGHE,GAAmB,SAAC,GAAD,IAAGC,EAAH,EAAGA,WAAH,OACtBA,GACC,uCACE,eAACC,GAAA,EAAD,CAAQC,SAAUF,EAAW/E,QAAS9I,KAAM6M,GAA5C,SACE,gBAACmB,GAAA,EAAD,WACGH,EAAWxH,SADd,IACwB,wBADxB,IACgCgD,KAAK4E,UAAUJ,EAAW/E,cAG5D,eAAC,GAAD,CAASA,QAAS+E,EAAW/E,UAC7B,eAACoF,GAAA,EAAD,CAAQC,OAAQN,EAAW/E,QAASrD,OAAQoI,EAAWpI,aAG3D,MAiBI2I,GAAW,SAAC,GAAD,IAAGC,EAAH,EAAGA,gBAAH,OACdA,GACCA,EAAgBvS,KAAI,SAACwS,EAAKpQ,GACxB,IACMqQ,EADa,GACED,EAAInJ,QAAQ/F,OACjC,OACE,eAAC,IAAMoP,SAAP,UACGF,EAAInJ,QAAQrJ,KAAI,SAAC6L,EAAQ8G,GAAT,OACf,eAACC,GAAA,EAAD,CACE5O,MAAOuB,EAAYsG,GACnBgH,QAAS,IACTC,UAAWN,EAAIO,WACfC,OATW,GASHL,EAAiBF,EAAe,EAAIQ,EAE5CC,OAXW,IAKb,iBAKiB9Q,EALjB,iBAK2BuQ,EAL3B,YAKgC9G,QAPpC,iBAA+BzJ,QAerC,MAEI+Q,GAAa,SAAC,GAAiB,IAAfC,EAAc,EAAdA,QACpB,EAAgCzE,mBAAS,MAAzC,mBAAOpE,EAAP,KAAiB8I,EAAjB,KAaA,OAZAvC,qBAAU,WACR,sBAAC,4BAAA7P,EAAA,sEACyBmS,EAAQ7I,SADjC,QACO+I,EADP,QAOGD,EAAYC,GAJZvH,QAAQe,MAAR,6CACwCsG,EAAQrP,MADhD,aAC0DqP,EAAQG,OADlE,OAHH,0CAAD,KAUC,IAED,eAACC,GAAA,EAAD,CACEnB,OAAQe,EAAQG,OAChB5J,OAAQ,GACR3F,MAAM,OACNyP,UAAU,OACVC,YAAa,GACbb,QAAS,GACTK,OAAQ,EACRS,cAAe,CACbC,MAAM,WAAD,4BAAE,sBAAA3S,EAAA,0FAAF,kDAAC,IATV,SAcE,eAACiR,GAAA,EAAD,UACE,uBAAK2B,MAAO,CAAEC,WAAY,OAA1B,UACGV,EAAQrP,MACT,wBACEwG,GAAQ,UAAOA,EAAP,OAAwB,uBAHpC,QAIQ6I,EAAQW,KACd,wBACCrC,GAAgB0B,EAAQzB,WACzB,eAAC,GAAD,CAAepH,SAAUA,IACzB,eAAC,GAAD,CAAYA,SAAUA,IACtB,eAAC,GAAD,CAAcA,SAAUA,IACxB,eAAC,GAAD,CAAiBA,SAAUA,YAO/ByJ,GAAc,SAAC,GAAD,IAAGC,EAAH,EAAGA,SAAH,OACjBA,GACCA,EAASjU,KAAI,SAACoT,GAAD,OACX,eAAC,GAAD,CAAYA,QAASA,GAAcA,EAAQrP,WAE/C,MAsEatC,GApEH,SAAC,GAAuD,IAArDsQ,EAAoD,EAApDA,WAA8BmC,GAAsB,EAAxCC,iBAAwC,EAAtBD,iBAC3C,EAA8CvF,qBAA9C,mBAAO4D,EAAP,KAAwB6B,EAAxB,KACA,EAAgCzF,qBAAhC,mBAAOsF,EAAP,KAAiBI,EAAjB,KAwDA,OAtDAvD,qBAAU,WACR,sBAAC,kCAAA7P,EAAA,yDACMiT,EADN,wDAEOI,EAAkB,IAAIC,IAAM,CAAEC,OAAO,KAC3BC,OAAOP,GACjBQ,EAAmB,GACzBJ,EAAgBK,aAAY,SAACC,EAAD,EAAmBC,EAAUC,GAAY,IAAhCjJ,EAA+B,EAA/BA,OAC7BkJ,EAAS,CAACF,EAAUC,GAAQE,OAAOzI,WACzC,EACE+H,EAAgBW,kBAAkBJ,GADvBK,EAAb,EAAQjL,IAAmBkL,EAA3B,EAAsBjL,IAEtB,EACEoK,EAAgBW,kBAAkBH,GADvBM,EAAb,EAAQnL,IAAiBoL,EAAzB,EAAoBnL,IAEd6K,KAAUL,IACdA,EAAiBK,GAAU,CACzBhC,WAAY,CACV,CAACmC,EAASC,GACV,CAACC,EAAOC,IAEVhM,QAAS,KAGbqL,EAAiBK,GAAQ1L,QAAQiM,KAAKzJ,MAExCuI,EAAmBtS,OAAOH,OAAO+S,IAtBlC,SAuBmBhJ,GAvBnB,OAuBO6J,EAvBP,OAwBOC,EAAY,GAClBlB,EAAgBmB,aAAY,SAACjU,EAAKkU,GAChC,IAII/J,EACAG,EAN2C,EACvC7B,EAA6ByL,EAA7BzL,IAAKC,EAAwBwL,EAAxBxL,IAAK/B,EAAmBuN,EAAnBvN,MAAUwN,EAA5B,aAAqCD,EAArC,IACM7K,EAAS,CAACZ,EAAKC,GACfK,EAAWK,GAAsBC,GACjC8G,EAAY,GAJ6B,cAO1BxJ,GAP0B,IAO/C,2BAA4B,CAAC,IAAhBiB,EAAe,QAAfA,GACX,GAAMA,KAAMmM,EAML,CAAC,IAAD,EACqBA,EAAInM,GAA3BuC,EADE,EACFA,SAAUG,EADR,EACQA,aAPG,CAChBH,EAAW,iBACXG,EAAW1C,EACX,IAAMwM,EAAI,iDAA6CxM,EAA7C,wBAA+DsM,EAAWhW,MACpFqM,QAAQe,MAAM8I,GAKVjK,KAAYgG,IAChBA,EAAUhG,GAAY,IAExBgG,EAAUhG,GAAU2J,KAAKxJ,IApBoB,8BAsB/C0J,EAAUF,KAAV,yBAAiB/B,OAAQ1I,EAAQN,WAAUpC,SAAUwN,GAArD,IAA2DhE,kBAE7D0C,EAAYmB,GAjDb,2CAAD,KAmDC,CAACtB,IAGF,gBAAC2B,GAAA,EAAD,CAAcxD,OAAQ,CAAC,QAAS,KAAOyD,KAAM,GAAIC,iBAAe,EAAhE,UACE,eAAC,GAAD,IAEA,eAAC,GAAD,CAAUxD,gBAAiBA,IAC3B,eAAC,GAAD,CAAa0B,SAAUA,IACvB,eAAC,GAAD,CAAkBlC,WAAYA,Q,UC5SvBiE,I,cAAa,SAACC,EAAmBC,GAAsD,IAAlCC,EAAiC,uDAAP,GAChE,qBAAfF,IACTA,EAAWR,aAAY,SAACW,EAAMV,GAAgB,IAAD,gBACrBS,GADqB,IAC3C,2BAAoC,CAAC,IAA1BE,EAAyB,QAC9BC,EAAmB,IAAI7T,IACvByT,EAAYK,QAAQH,KACtBE,EAAmBJ,EAAYM,iBAAiBJ,EAAMC,IAAY,IAAI5T,KAExE,IAAMgU,EAAoBR,EAAWO,iBAAiBJ,EAAMC,IAAY,IAAI5T,IACtEiU,EAAelU,EAAS8T,EAAkBG,GAC5CC,EAAa1I,KAAO,IACtB0H,EAAWW,GAAWK,IATiB,8BAY3CR,EAAYS,UAAUP,EAAMV,MAE9BO,EAAWtB,aAAY,SAACC,EAAMc,EAAYb,EAAUC,GAClD,MACEoB,EAAYU,iBAAiBhC,EAAMC,EAAUC,EAAQY,GADvD,6CAeOmB,GAAmB,SAACC,GAG/B,IAFA,IAAMC,EAAUjV,OAAOH,OAAOM,EAAU6U,GAAa,qBAAGtC,UAAwCwC,MAAK,SAAC3U,GAAD,OAAOA,KACtG6T,EAAc,IAAI3B,IAAM,CAAEC,MAAOuC,IACvC,MAAoBjV,OAAOH,OAAOmV,GAAlC,eAAgD,CAA3C,IAAMG,EAAK,KACdjB,GAAWiB,EAAOf,GAEpB,OAAOA,GAgCIgB,GAAoB,uCAAG,mEAAAjW,EAAA,6DAClC4K,EADkC,EAClCA,OACAjD,EAFkC,EAElCA,UAFkC,IAGlCuO,qBAHkC,MAGlB,YAHkB,MAIlC3C,aAJkC,SAW5B4C,EAAY,IAAI7C,IAAM,CAACC,UAXK,SAYNrH,GAAgBtB,GAZV,UAY5BuB,EAZ4B,OAa5BtB,EAAWsB,EAActB,SACT,OAAlBsB,EAd8B,yCAcCgK,GAdD,OAe7BhK,EAAciK,mBAAmB/T,SAC9BsS,EADqC,yCACG9J,EADH,uDAE3CC,QAAQe,MAAM8I,GACd0B,IAAMxK,MAAM8I,EAAM,CAAExM,GAAIwM,KAEpB2B,EACJhS,EAAY6H,EAAcvB,SAC1BhI,EAAeuJ,EAAcyE,MAAM7N,MACvB2H,EAAayB,EAAnByE,KAvB0B,cAwBFzE,EAAciK,oBAxBZ,IAwBlC,2BACE,IADSG,EAAuD,SAC1C5O,YAAcA,EAElC,IADM6O,EAAiBD,EAAkBrJ,UAChC/L,EAAI,EAAGA,EAAIqV,EAAenU,OAAS,EAAGlB,GAAK,EAC5CsV,EAASD,EAAerV,GACxBuV,EAAOF,EAAerV,EAAI,GACtB,IAANA,GACFgV,EAAUT,UAAUe,EAAOP,GAA3B,2BACKO,GADL,IAEE5J,EAAG4J,EAAOxN,IACV0N,EAAGF,EAAOzN,IACVlG,MAAO2T,EAAOhY,KACdsE,MAAOuT,EACPvJ,KX8BmB,KW3BvBoJ,EAAUT,UAAUgB,EAAKR,GAAzB,2BACKQ,GADL,IAEE7J,EAAG6J,EAAKzN,IACR0N,EAAGD,EAAK1N,IACRlG,MAAO4T,EAAKjY,KACZsE,MAAOuT,EACPvJ,KXqBqB,KWnBjB+G,EAAS,CAAC2C,EAAOP,GAAgBQ,EAAKR,IAE5CC,EAAUR,iBACRrJ,KAAK4E,UAAU,CAACtG,SAAQkJ,WAExBA,EAAO,GACPA,EAAO,GACP,CACElJ,SACAF,WACAkM,KX0Ba,QWzBb7J,KAAM,EACNhK,MAAOuT,EACPxT,MAAO+H,EACPlD,cA9DwB,uDAoE3BwO,GApE2B,4CAAH,sDAuEpBU,GAA0B,SAAC7B,GACtC,IAAMC,EAAc,IAAI3B,IAAM,CAACC,MAAOyB,EAAWzB,QAUjD,OATAyB,EAAWR,aAAY,SAACW,EAAMV,GAC5BQ,EAAYS,UAAUP,EAAMV,MAE9BO,EAAWtB,aAAY,SAACC,EAAMc,EAAYb,EAAUC,GAClD,IAAMiD,EAAWxK,KAAKC,MAAMoH,GACpBG,EAAWgD,EAAXhD,OACRA,EAAOC,OACPkB,EAAYU,iBAAiBrJ,KAAK4E,UAAU4F,GAAWhD,EAAO,GAAIA,EAAO,GAAIW,MAExEQ,GAGI8B,GAAgC,uCAAG,WAC9CC,GAD8C,+CAAAhX,EAAA,sDAE9CiX,EAF8C,+BAEjB,CAAC,YAC9BC,EAH8C,gCAI9C3D,IAJ8C,iCAMxC4D,EAAyC,GAND,cAOzBH,GAPyB,yDAOnCpM,EAPmC,sBAQpBqM,GARoB,kEAQjCtP,EARiC,kBASpBsO,GAAqB,CAAErL,SAAQjD,YAAW4L,UATtB,QAStC4C,EATsC,OAUtCe,IAAcf,EAAYiB,mBAAQjB,IAEtCgB,EAAgBvM,GAAUuL,EAZgB,iTAevCgB,GAfuC,8EAAH,sD,kFC7J7C,SAASE,GAAYC,GAA2D,IAA7BC,EAA4B,uDAAJ,GACzE,GAAkB,OAAdD,EAAoB,OAAOC,EAE/B,GADAA,EAAelD,KAAKiD,EAAUnP,IAC1ByE,MAAM4K,QAAQF,EAAU7J,UAAW,CAAC,IAAD,gBAClB6J,EAAU7J,UADQ,IACrC,2BAAuC,CAAC,IAA7B0H,EAA4B,QACrCkC,GAAYlC,EAAMoC,IAFiB,+BAKvC,OAAOA,EAGT,SAASE,GAAkBC,GAAmD,IAAhC3Y,EAA+B,uDAAJ,GACvE,IAAK2Y,EAAMjK,SACT,OAAO,KAET1O,EAAI2Y,EAAMvP,IAAMkP,GAAYK,GAAOC,OAAO,GAJiC,oBAKnDD,EAAMjK,UAL6C,IAK3E,2BAAwC,CAAC,IAA9B6J,EAA6B,QACtCG,GAAkBH,EAAWvY,IAN4C,8BAQ3E,OAAOA,EAIT,SAAS6Y,GAAYzC,EAAkBhN,EAAY0P,GACjD,IAAInO,EAAS,KACb,GAAIyL,EAAKhN,KAAOA,EACd,OAAOgN,EAET,GAAIvI,MAAM4K,QAAQrC,EAAK1H,UAAW,CAAC,IAAD,gBACR0H,EAAK1H,UADG,IAChC,2BAAuC,CAErC,GADA/D,EAASkO,GAD4B,QACLzP,EAAI0P,GAGlC,OADAA,EAAYxD,KAAKc,EAAKhN,IACfuB,GALqB,8BAQhC,OAAOA,EAET,OAAOA,EAGT,IAAMoO,GAAe,SAACJ,EAAmBvP,GACvC,IACM4P,EAAiB,GAIvB,MAAO,CAAEC,mBAAoBX,GAFRO,GAAYF,EAAOvP,EAAI4P,GAHpB,IAKuCA,SAGlD,eAUR,IATLrV,EASI,EATJA,KACAuV,EAQI,EARJA,YACAC,EAOI,EAPJA,YAOI,IANJC,uBAMI,MANc,GAMd,EAGJ,IAAMC,EAAcC,IAAMvK,SAAQ,kBAAM,IAAItM,IAAIyW,KAAc,CAACA,IACzDK,EAAYD,IAAMvK,SAAQ,kBAAM2J,GAAkB/U,KAAO,IA4D/D,OACE,eAAC6V,GAAA,EAAD,CACEJ,gBAAiBA,EACjBK,kBAAmB,eAAC,KAAD,IACnBC,oBAAqB,eAAC,KAAD,IACrB7F,MAAO,CAAE8F,UAAW,WAJtB,SA7CiB,SAAbC,EAAcjB,GAAuB,IAAD,IAClCkB,EAAmB,OAAGN,QAAH,IAAGA,GAAH,UAAGA,EAAYZ,EAAMvP,WAArB,aAAG,EAAuB0Q,OACjD,SAACC,GAAD,OAAyBV,EAAYtL,IAAIgM,MAErCC,EAAUX,EAAYtL,IAAI4K,EAAMvP,KAAOyQ,IAAuB,EAE9DI,GACK,OAATV,QAAS,IAATA,GAAA,UAAAA,EAAYZ,EAAMvP,WAAlB,eAAuB4N,MAAK,SAAC+C,GAAD,OAC1BV,EAAYtL,IAAIgM,SACb,EAOP,OALIF,IAAwBR,EAAYtL,IAAI4K,EAAMvP,KAEhD+P,EAAY,GAAD,mBAAKD,GAAL,CAAkBP,EAAMvP,MAInC,eAAC8Q,GAAA,EAAD,CAEEC,OAAQxB,EAAMvP,GACdrF,MACE,eAACqW,GAAA,EAAD,CACEC,QACE,eAACC,GAAA,EAAD,CACEN,QAASA,EACTC,eAAgBD,GAAWC,EAC3BM,SAAU,SAACC,GAAD,OAvCxB,SAAqBR,EAAkBrB,GACrC,MAAqCI,GAAapV,EAAMgV,EAAMvP,IAAtD6P,EAAR,EAAQA,mBAAoBD,EAA5B,EAA4BA,KAGxByB,EAAQT,EAAO,sBACXd,GADW,YACKD,IACpBC,EACG3W,QAAO,SAACW,GAAD,OAAY+V,EAAmByB,SAASxX,MAC/CX,QAAO,SAACW,GAAD,OAAY8V,EAAK0B,SAASxX,MACxCuX,EAAQA,EAAMlY,QAAO,SAACF,EAAGD,GAAJ,OAAUqY,EAAME,QAAQtY,KAAOD,KACpD+W,EAAYsB,GA8BEG,CAAYJ,EAAMK,cAAcb,QAASrB,IAE3CmC,QAAS,SAACC,GAAD,OAAOA,EAAEC,qBAGtBjX,MAAO,qCAAG4U,EAAMjZ,QACXiZ,EAAMvP,IAhBjB,SAoBGyE,MAAM4K,QAAQE,EAAMjK,UACjBiK,EAAMjK,SAAS1O,KAAI,SAACoW,GAAD,OAAUwD,EAAWxD,MACxC,MArBCuC,EAAMvP,IAiCZwQ,CAAWjW,MCxCHsX,GA9EO,SAAC,GAMhB,IALL/B,EAKI,EALJA,YACAC,EAII,EAJJA,YAUA,EAAwBxK,qBAAxB,mBAAOhL,EAAP,KAAauX,EAAb,KAsDA,OAnDApK,qBAAU,WACR,sBAAC,8CAAA7P,EAAA,6DACOka,EAA2B,CAC/B/R,GATW,aAUX1J,KATc,YAUdgP,SAAU,IAERzG,EAAgB,GANrB,SAQgBzE,EAAe6H,GAAf7H,GARhB,OAQCyE,EARD,OASOsD,EAAYtD,EACf1F,QACC,SAACsP,GAAD,OACEA,EAAKuJ,oBACLvJ,EAAKwJ,eACJxJ,EAAKyJ,cAAkC,kBAAlBzJ,EAAKlG,aAE9B3L,KAAI,qBAAG2L,YACPpJ,QACC,SAACoJ,GAAD,OACE9H,EAAe8H,KAAc9H,EAAe8H,GAAUxH,UAGtDoX,EAAkBhQ,EAAUhJ,QAChC,SAACoJ,GAAD,OAAchH,EAAcgH,MAE9BwN,EAAYoC,GAEN7M,EAAyB,GA3BhC,cA4BwBnD,GA5BxB,2DA4BYI,EA5BZ,QA6BS6P,EAAoB,CACxBpS,GAAIuC,EACJjM,KAAMmE,EAAe8H,GAAU5H,OAAS4H,GA/B7C,wBAkCW8P,EAlCX,OAoCOzb,KAAI,kBAAmB,CACvBoJ,GADI,EAAGA,GAEP1J,KAFI,EAAOA,SAIb8b,EAAM9M,SAAW+M,EAxCtB,QA0CG/M,EAAS4G,KAAKkG,GA1CjB,iJA4CCL,EAAazM,SAAWA,EAExBwM,EAAQC,GA9CT,gEAAD,KAgDC,IAECxX,EAEA,eAAC+X,GAAD,CACE/X,KAAMA,EACNuV,YAAaA,EACbC,YAAaA,EACbC,gBA1D4B,KA8D3B,oECxBHuC,GAAiB,SACrB1E,EACA9I,EACArC,GAGAmL,EAAMN,UAAUxI,EAAS,UAAzB,2BACKA,GADL,IAEEL,EAAGK,EAAUjE,IACb0N,EAAGzJ,EAAUlE,IACblG,MAAOoK,EAAUzO,KACjBsE,MAAOuB,EAAYuG,OAiBjB8P,GAAgB,SAACb,GACrB,GAAc,UAAVA,EAAEvZ,KAA6B,WAAVuZ,EAAEvZ,IACzB,GAAc,UAAVuZ,EAAEvZ,IAAiB,CAGrB,IAFA,IAAQqa,EAASd,EAAEhL,OAAX8L,KAECzZ,EADK,YAAIyZ,GAAMlB,QAAQI,EAAEhL,QACb,EAAG3N,EAAIyZ,EAAKvY,OAAQlB,IAAK,CAC5C,IAAM0Z,EAAUD,EAAKE,SAAS3Z,GAC9B,GAA0B,UAAtB0Z,EAAQE,UAAuB,CACjCF,EAAQG,QACR,OAGJlB,EAAEmB,sBAEFnB,EAAEhL,OAAOoM,QAKTC,GAAkB,SAAC,GAAD,IACtB1c,EADsB,EACtBA,KACAqE,EAFsB,EAEtBA,MACAsY,EAHsB,EAGtBA,WACAC,EAJsB,EAItBA,iBACAxP,EALsB,EAKtBA,MALsB,OAOtB,eAACyP,EAAA,EAAD,CACEnT,GAAE,gBAAW1J,GACbA,KAAMA,EACNqE,MAAOA,GAASrE,EAChB8c,QAAQ,WACRC,aAAcJ,EAAW3c,GACzBgd,OAAQJ,EACRK,UAAWf,GACX9O,MAAOA,IAAS,KAId8P,GAAiB,SAAC,GAAD,IACrBld,EADqB,EACrBA,KACAqE,EAFqB,EAErBA,MACAsY,EAHqB,EAGrBA,WACAQ,EAJqB,EAIrBA,gBACAC,EALqB,EAKrBA,UACAhQ,EANqB,EAMrBA,MANqB,IAOrBiQ,aAPqB,gBASrB,eAACR,EAAA,EAAD,CACEnT,GAAE,gBAAW1J,GACbA,KAAMA,EACNqE,MAAOA,GAASrE,EAChB8c,QAAQ,WACRtZ,MAAOmZ,EAAW3c,GAClB6a,SAAU,SAACQ,GAAD,OAAO8B,EAAgB9B,EAAGgC,IACpCJ,UAAWf,GACXoB,WACEF,EAAS,yBAECA,EAAUjF,KAFX,aAGD,eAACoF,EAAA,EAAD,CAAgBhL,SAAU6K,EAAUjF,KAApC,SACGiF,EAAUI,QAIjB,KAENpQ,MAAOA,IAAS,KAoYLqQ,GAhYH,WACV,MAAwBxO,mBAAS,yBAAjC,mBAAOiH,EAAP,KAAawH,EAAb,KACA,EAA0BzO,oBAAS,GAAnC,mBAAO0O,EAAP,KAAeC,EAAf,KAKA,EAA4C3O,mBAAS,IAAI4F,KAAzD,mBAAuBgJ,GAAvB,WAKA,EACE5O,qBADF,mBAAOoD,EAAP,KAAmByL,EAAnB,KAEA,EAAgD7O,mBAAsB,IAAtE,mBAAOwF,EAAP,KAAyBsJ,EAAzB,KACA,EAA8C9O,qBAA9C,mBAAOuF,EAAP,KAAwBwJ,EAAxB,KAEA,EAA6C/O,mBAAmB,IAAhE,mBAAOgP,EAAP,KAAyBC,EAAzB,KAEMC,EAAkB,CACtB,uBd9B4B3S,Wc+B5B,qBd1C0B,Kc6C5B,EAAgCyD,mBAASkP,GAAzC,mBAAOC,EAAP,KAAiBC,EAAjB,KAEA,EAAsC7O,qBAAWX,IAAzCK,EAAR,EAAQA,WAAYC,GAApB,EAAoBA,cAEpBiC,qBAAU,WAGR,IAAMkN,EAAY,IAAI1R,gBAAgB2R,OAAOC,SAASC,QAChD7X,EAASxE,OAAOC,YAAYic,GAC5BI,EAAY9b,EAAagE,GAAQ,SAACjE,EAAGL,GAAJ,OAAUA,KAAK6b,KAChDQ,EAAc/b,EAAagE,GAAQ,SAACjE,EAAGL,GAAJ,OAAUA,KAAKsM,MACxDyP,EAAY,2BAAKD,GAAaM,IAC9BvP,GAAc,2BAAKD,GAAeyP,IAClCf,GAAQ,KACP,IAEH,IAAMhB,GAAmB,SAACvB,GAAqB,IAAlB7X,EAAiB,uDAAT,KAC7Bob,EAAMvD,EAAEhL,OAAOrQ,QAAQme,EACvBU,EAAQD,EAAMP,EAAclP,GAC5BwN,EAAaiC,EAAMR,EAAWlP,EACpC2P,EAAM,2BACDlC,GADA,kBAEFtB,EAAEhL,OAAOrQ,KAAiB,OAAVwD,EAAiBA,EAAQ6X,EAAEhL,OAAO7M,UAIjD2Z,GAAkB,SAAC9B,GAA2B,IAAxByD,EAAuB,wDAI3CC,EAAUD,EAAa,WAAa,UACpCE,EAAW3D,EAAEhL,OAAO7M,MAAMkM,QAAQqP,EAAS,IACjDnC,GAAiBvB,EAAG2D,IAIhBC,GAAY,WAChB,IAAMC,EAAc,IAAItS,gBAAJ,2BACfwR,GACAlP,IACFrC,WACH0R,OAAOY,QAAQC,UAAU,GAAI,GAA7B,WAAqCF,KAGjCG,GAAiB,uCAAG,WAAOhE,GAAP,wFAAA9Z,EAAA,6DACxB8Z,EAAEmB,iBACFyC,KAKMK,EAAU,QAGhBC,EAAK,iDAA6CnB,EAAS,wBAAtD,OACLV,EAAQ6B,GACR3H,IAAM4H,QAAQD,EAAO,CAAE7V,GAAI4V,IAZH,SAaF1U,GACpBwT,EAAS,yBAda,YAalB9Q,EAbkB,yBAiBtBsK,IAAM6H,QAAQF,EAAO,CAAE7V,GAAI4V,IAjBL,+BAmBtBC,EAAK,oBAAgBnB,EAAS,wBAAzB,eACLV,EAAQ6B,GACR3H,IAAMxK,MAAMmS,EAAO,CAAE7V,GAAI4V,IArBH,kCAyBxBxB,EAAc,CACZjT,SAAUuT,EAAS,wBACnB9Q,UACArD,OAAQmU,EAAS,wBAInBmB,EAAK,qCACHnB,EAAS,sBADN,sBAESA,EAAS,wBAFlB,aAE8CvQ,KAAK4E,UACtDnF,GAHG,QAKLoQ,EAAQ6B,GACR3H,IAAM4H,QAAQD,EAAO,CAAE7V,GAAI4V,IAtCH,UAuCDjS,GACrBhH,GACAiH,EACA8Q,EAAS,uBA1Ca,WAuCpB5Q,EAvCoB,OA4CxBoK,IAAM6H,QAAQF,EAAO,CAAE7V,GAAI4V,IAID,IAAtB9R,EAAW5J,OAhDS,wBAiDtB8Z,EAAQ,yBAAD,OACoBU,EAAS,sBAD7B,+BACyEA,EAAS,0BAlDnE,kCAuDlBpQ,EAAiB,IAAIjL,IAAIkb,GAvDP,UAwDLlQ,GACjBP,EACAQ,OACAhH,OACAA,GA5DsB,QAwDxBwG,EAxDwB,OA8DxBuQ,EAAoBvQ,IAEdkS,EAAUlS,EAAWlN,KAAI,gBAAGqf,EAAH,EAAGA,WAAYhR,EAAf,EAAeA,SAAf,MAA+B,CAC5DgR,aACAhR,SAA8B,qBAAbA,EAA2BhO,KAAKyC,MAAMuL,GAAY,WAE7D2G,MAAK,SAAC/T,EAAGpB,GAAJ,OAAWoB,EAAEoN,SAAWxO,EAAEwO,SAAW,GAAK,KACjDiR,EAAcF,EAAQpf,KAC1B,gBAAGqf,EAAH,EAAGA,WAAYhR,EAAf,EAAeA,SAAf,gBAAiCgR,EAAjC,aAAgDhR,EAAhD,SAEF+O,EAAQ,gBAAD,OACWU,EAAS,sBADpB,+BAEHA,EAAS,wBAFN,aAGAvQ,KAAK4E,UAAUnF,GAHf,cAG6BsS,EAAY7X,KAAK,QAGrDwX,EAAQ,kBACR3H,IAAM4H,QAAQD,EAAO,CAAE7V,GAAI4V,IAErBO,EAA6B,GAC7BC,EAGF,GArFoB,cAsFAtS,GAtFA,IAsFxB,2BAAoC,CAAzBiB,EAAyB,sBACSA,EAAUsR,gBADnB,IAClC,2BACE,GADoE,EAAD,QAAxD9T,EAAwD,EAAxDA,SAAU+T,EAA8C,EAA9CA,eACjBhS,EAAeK,IAAIpC,GAAW,CAAC,EAAD,YACb+T,GADa,IAChC,2BAAW1X,EAAwB,QAEwB,qBAAvD,OAAOwX,QAAP,IAAOA,GAAP,UAAOA,EAA0B7T,UAAjC,aAAO,EAAsC3D,MAE7CjF,EAAgByc,EAAyB,CAAC7T,EAAU3D,GAAO,IAC3DuX,EAAiBjK,KAAKtN,IAExBwX,EAAwB7T,GAAU3D,GAAMsN,KAAKnH,GARf,gCAFF,gCAtFZ,8BAqGlBqG,GAAQ,EAGRmL,EAA0B,CAAC,UAAW,YAExCC,EAAoB,IAAIrL,IAAM,CAAEC,UACb,IAAID,IAAM,CAAEC,UA3GX,MA6GG,EAAC,GAAM,GA7GV,0CA6Gb2D,EA7Ga,KA+GhB0H,EACJje,EAAuB+d,GAAY,kBAAM,IAAIpL,IAAM,CAAEC,aAhHjC,cAkHEmL,GAlHF,kEAkHX/W,EAlHW,kBAoHZoP,GACJuH,EACA,CAAC3W,GACDuP,GACA,GAxHgB,QA6HpB,IAAWxM,KAVLmU,EAnHc,OA2HpBD,EAAqBjX,GAAa,IAAI2L,IAAM,CAAEC,UAEvBgL,EACrB,IAAW3T,KADoC,EAAD,SACnCA,GACT,IAF4C,EAEtCkU,EACJ,IAAIxL,IAAM,CAAEC,UACRwL,EAAqBF,EAA2BjU,GAJV,cAKpB2T,EAAwB7T,GAAUE,IALd,IAK5C,2BAAmE,CAAC,IAAzDsC,EAAwD,QAI7D6R,EAAmBzJ,QAAQpI,EAAU8R,gBACvCC,sBACEF,EACA7R,EAAU8R,eACV,SAAC7J,EAAM+J,GACLxE,GACEoE,EACAI,EACAtU,OAjBkC,8BA2B5C,IAAMuU,EAAMC,IACVL,EACAD,EAAmDpH,SASrD3C,GAAWoK,EAAKP,EAAqBjX,KArClB4W,EAAwB7T,GAAY,EAA9CE,GA9HO,iJAuKlByU,EAAmBzJ,GAAiBgJ,GACpC1H,GACFmI,EAAmBjI,IAAQiI,GAERA,GAGnBV,EAAoBU,EA9KA,oCAmLxB/C,GAFMjJ,GAAkBsL,GAEUW,QAClC7C,EAAmB5F,GAAwBxD,IAAiBkM,UAC5DlJ,IAAM6H,QAAQF,EAAO,CAAE7V,GAAI4V,IArLH,iEAAH,sDAwLjByB,GAAeC,uBACnB,kBACE,+BACE,eAACC,EAAA,EAAD,CACEnE,QAAQ,YACRxY,MAAM,UACN6T,KAAK,SAEL+I,SACE9C,EAAS,uBAAyB,IACjCA,EAAS,wBAPd,0BAcJ,IAGF,OAAIT,EAAe,KAEjB,gBAACwD,EAAA,EAAD,CAAWC,SAAS,KAAKC,UAAU,MAAnC,UACE,gBAACC,EAAA,EAAD,WACE,sBAAKC,IAAKC,GAAMH,UAAU,WAAWI,IAAI,SACzC,eAACC,EAAA,EAAD,CAAY5E,QAAQ,KAAK6E,UAAU,KAAKC,cAAY,EAApD,0BAGA,eAAC,GAAD,CACEpI,YAAayE,EACbxE,YAAayE,IAEf,gBAAC2D,EAAA,EAAD,CACEC,WAAS,EACTC,UAAW,EACXC,GAAI,CAAE,uBAAwB,CAAEC,EAAG,EAAGC,MAAO,SAC7CC,WAAW,SAJb,UAME,gBAACN,EAAA,EAAD,CACE7f,MAAI,EACJogB,GAAI,GACJC,GAAI,EACJV,UAAU,OACVW,SAAUjD,GALZ,UAOE,eAACqC,EAAA,EAAD,CAAY5E,QAAQ,KAApB,oBACA,eAAC,GAAD,CACE9c,KAAK,uBACLqE,MAAM,+BACNsY,WAAYyB,EACZxB,iBAAkBA,GAClBxP,OAAQgR,EAAS,0BAEnB,eAAC,GAAD,CACEpe,KAAK,qBACLqE,MAAM,oCACNsY,WAAYyB,EACZjB,gBAAiBA,GACjBC,UAAW,CAAEjF,KAAM,MAAOqF,KAAM,KAChCpQ,MAAOgR,EAAS,uBAAyB,IAE3C,eAAC2C,GAAD,OAEF,gBAACc,EAAA,EAAD,CACE7f,MAAI,EAEJogB,GAAI,GACJC,GAAI,EAJN,UAME,eAACX,EAAA,EAAD,CAAY5E,QAAQ,KAApB,qBACA,eAAC,GAAD,CACE9c,KAAK,eACLqE,MAAM,gBACNsY,WAAYzN,EACZiO,gBAAiBA,GACjBC,UAAW,CAAEjF,KAAM,MAAOqF,KAAM,UAElC,eAAC,GAAD,CACExd,KAAK,eACLqE,MAAM,gBACNsY,WAAYzN,EACZiO,gBAAiBA,GACjBC,UAAW,CAAEjF,KAAM,MAAOqF,KAAM,UAElC,eAAC,GAAD,CACExd,KAAK,YACLqE,MAAM,aACNsY,WAAYzN,EACZiO,gBAAiBA,GACjBC,UAAW,CAAEjF,KAAM,QAASqF,KAAM,UAEpC,eAAC,GAAD,CACEH,OAAK,EACL3T,GAAG,oBACH1J,KAAK,cACLqE,MAAM,6BACNyY,QAAQ,WACRH,WAAYzN,EACZiO,gBAAiBA,GACjBC,UAAW,CAAEjF,KAAM,MAAOqF,KAAM,iBAItC,6BAAItH,IAGJ,eAAC,GAAD,CACE7D,WAAYA,EACZoC,iBAAkBA,EAClBD,gBAAiBA,IAInB,qBAAGL,MAAO,CAAEoO,SAAU,IAAtB,UACE,oBACEpO,MAAO,CAAEoO,SAAU,IACnBnS,KAAK,sDAFP,yBAMA,wBAPF,2BASE,wBATF,gIAcF,eAAC,IAAD,Q,mBChhBSoS,GA7BDC,aAAY,CACxBC,QAAS,CACPvQ,KAAM,OACNwQ,QAAS,CACPC,KAAM,UACNC,MAAO,UACPC,KAAM,WAERC,UAAW,CACTH,KAAM,UACNC,MAAO,UACPC,KAAM,WAER1V,MAAO,CAAEwV,KAAMI,KAAIC,MACnBC,WAAY,CAAEC,QAAS,YAEzBC,WAAY,CACVC,SAAU,CACRC,eAAgB,CACdC,KAAM,CACJC,QAAS,YACTC,OAAQ,UAKdC,UAAW,CAAEJ,eAAgB,CAAEC,KAAM,CAAEE,OAAQ,YChBpCE,GAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCMdQ,IAASC,OACP,eAAC,IAAMC,WAAP,UACE,eAACC,EAAA,EAAD,CAAe/B,MAAOA,GAAtB,SACE,gBAAC,GAAD,WACE,eAACgC,EAAA,EAAD,IACA,eAAC,GAAD,WAINC,SAASC,eAAe,SAM1Bf,O","file":"static/js/main.99cf90c0.chunk.js","sourcesContent":["import Color from \"color\";\r\n\r\nconst pantone = require(\"./@PANTONE.palette.json\");\r\n\r\ntype PantonePaletteColor = {\r\n  name: string;\r\n  r: number;\r\n  g: number;\r\n  b: number;\r\n};\r\n\r\nconst pantonePalette: Record<string, string> = {};\r\npantone.forEach(({ name, r, g, b }: PantonePaletteColor) => {\r\n  pantonePalette[name] = Color.rgb([r, g, b].map((ch) => ch * 255)).hex();\r\n});\r\n\r\nexport default pantonePalette;\r\n","/* eslint-disable */\r\n\r\n// remove pairs where value is false, then extract only keys to list\r\nexport const objectKeysToList = (obj) =>\r\n  Object.entries(obj)\r\n    .filter(([key, value]) => value)\r\n    .map(([key, value]) => key);\r\n// .join();\r\n\r\nfunction deg2rad(deg) {\r\n  return deg * (Math.PI / 180);\r\n}\r\n\r\nexport const getDistanceFromLatLonInKm = (loc1, loc2) => {\r\n  const [lat1, lon1] = loc1;\r\n  const [lat2, lon2] = loc2;\r\n  // https://stackoverflow.com/q/18883601\r\n  const R = 6371; // Radius of the earth in km\r\n  const dLat = deg2rad(lat2 - lat1);\r\n  const dLon = deg2rad(lon2 - lon1);\r\n  const a =\r\n    Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n    Math.cos(deg2rad(lat1)) *\r\n    Math.cos(deg2rad(lat2)) *\r\n    Math.sin(dLon / 2) *\r\n    Math.sin(dLon / 2);\r\n  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n  const d = R * c; // Distance in km\r\n  return d;\r\n};\r\n\r\nexport const getUniqueListBy = (arr, key) => \r\n  // https://stackoverflow.com/a/56768137\r\n   [...new Map(arr.map((item) => [item[key], item])).values()]\r\n;\r\n\r\nexport const kvArrayToObject = (arr) => arr.reduce((result, item) => {\r\n    const key = Object.keys(item)[0]; // first property: a, b, c\r\n    result[key] = item[key];\r\n    return result;\r\n  }, {});\r\n\r\nexport const mapArrayOfKeysToObject = (arr, fn) => Object.fromEntries(arr.map(k => [k, fn(k)]))\r\n\r\nexport const objectMap = (obj, fn) =>\r\n  // https://stackoverflow.com/a/14810722\r\n  Object.fromEntries(\r\n    Object.entries(obj).map(\r\n      ([k, v], i) => [k, fn(v, k, i)]\r\n    )\r\n  )\r\n\r\nexport const objectFilter = (obj, fn) =>\r\n  Object.fromEntries(\r\n    Object.entries(obj).filter(\r\n      ([k, v], i) => fn(v, k, i)\r\n    )\r\n  );\r\n\r\nexport let getDescendants = (obj, key, currentDescendantIds = new Set(), level = 0) => {\r\n  // console.log(`getDescendants(L${level}: ${obj}, ${key}, ${JSON.stringify(currentDescendantIds)})`)\r\n  // console.log(descendantIds)\r\n  for (const id of currentDescendantIds) {\r\n    let newDescendantIds = new Set(obj[id][key].map(id => id.toString()))\r\n    newDescendantIds = setDifference(newDescendantIds, currentDescendantIds)\r\n    if (newDescendantIds.length > 0) {\r\n      const res = getDescendants(obj, key, newDescendantIds, level + 1)\r\n      currentDescendantIds = new Set([...currentDescendantIds, ...res].map(id => id.toString()))\r\n    }\r\n  }\r\n  return currentDescendantIds\r\n}\r\n\r\nexport const setDifference = (a, b) =>\r\n  new Set(\r\n    Array.from(a).filter(x => !b.has(x))\r\n  );\r\n\r\nexport const setIntersection = (a, b) => new Set(\r\n  Array.from(a).filter(x => b.has(x))\r\n);\r\n\r\nexport const setUnion = (a, b) => new Set([...a, ...b]);\r\n\r\nexport const roundAccurately = (number, decimalPlaces = 1) => Number(`${Math.round(`${number  }e${  decimalPlaces}`)  }e-${  decimalPlaces}`)\r\n// https://gist.github.com/djD-REK/068cba3d430cf7abfddfd32a5d7903c3\r\n\r\n\r\n/**\r\n * Function: createNestedObject( base, names[, value] )\r\n * @param {*} base The object on which to create the hierarchy.\r\n * @param {*} names An array of strings (or dot-separated string) contaning the names of the objects\r\n * @param {*} value (optional) if given, will be the last object in the hierarchy.\r\n * @returns The last object in the hierarchy.\r\n */\r\n export const setNestedObject = function( base, names, value ) {\r\n  // https://stackoverflow.com/a/11433067\r\n  if (typeof (names) === \"string\")\r\n    names = names.split(\".\")\r\n\r\n  // If a value is given, remove the last name and keep it for later:\r\n  var lastName = arguments.length === 3 ? names.pop() : false;\r\n\r\n  // Walk the hierarchy, creating new objects where needed.\r\n  // If the lastName was removed, then the last object is not set yet:\r\n  for( var i = 0; i < names.length; i++ ) {\r\n      base = base[ names[i] ] = base[ names[i] ] || {};\r\n  }\r\n\r\n  // If a value was given, set it to the last name:\r\n  if( lastName ) base = base[ lastName ] = value;\r\n\r\n  // Return the last object in the hierarchy:\r\n  return base;\r\n};\r\n\r\nexport const catchHttpError = (fn) => {\r\n  return (async function (...args){\r\n    try {\r\n      return await fn(...args);\r\n    } catch (e) {\r\n      alert(`${e.response.data} (Error code ${e.response.status})`);\r\n    }\r\n  })\r\n};\r\n","const enum TrackerNetLines {\r\n    Bakerloo = 'B',\r\n    Central = 'C',\r\n    District = 'D',\r\n    HammersmithCity = 'H',\r\n    Jubilee = 'J',\r\n    Metropolitan = 'M',\r\n    Northern = 'N',\r\n    Piccadilly = 'P',\r\n    Victoria = 'V',\r\n    WaterlooCity = 'W'\r\n}\r\n\r\nexport default TrackerNetLines;\r\n","import pantonePalette from \"./pantonePalette\";\r\nimport { objectFilter, objectMap } from \"./utils\";\r\n\r\ntype ModeInfo = {\r\n  label?: string;\r\n  color?: string;\r\n  selectedByDefault?: boolean;\r\n  icon?: string;\r\n  hidden?: boolean;\r\n};\r\n\r\ntype ModeInfoContainer = {\r\n  [key: string]: ModeInfo;\r\n};\r\n// only scheduled modes\r\nexport const MODES_INFO_ALL: ModeInfoContainer = {\r\n  bus: {\r\n    label: \"London Buses\",\r\n    color: pantonePalette[\"485\"],\r\n    selectedByDefault: false,\r\n    icon: \"fa-bus\",\r\n  },\r\n  \"cable-car\": { hidden: true },\r\n  coach: {\r\n    label: \"Victoria Coach Station\",\r\n    color: pantonePalette[\"130\"],\r\n    hidden: true,\r\n  },\r\n  dlr: {\r\n    label: \"Docklands Light Railway\",\r\n    color: pantonePalette[\"326\"],\r\n    icon: \"fa-subway\",\r\n    selectedByDefault: false,\r\n  },\r\n  \"national-rail\": {\r\n    label: \"National Rail\",\r\n    icon: \"fa-train\",\r\n    selectedByDefault: false,\r\n  },\r\n  overground: {\r\n    label: \"London Overground\",\r\n    color: pantonePalette[\"158\"],\r\n    selectedByDefault: true,\r\n    icon: \"fa-subway\",\r\n  },\r\n  \"replacement-bus\": { hidden: true },\r\n  \"river-bus\": {\r\n    label: \"London River Services\",\r\n    color: pantonePalette[\"299\"],\r\n    hidden: true,\r\n    icon: \"fa-ship\",\r\n  },\r\n  \"river-tour\": { hidden: true },\r\n  tflrail: {\r\n    label: \"TfL Rail\",\r\n    hidden: false,\r\n    icon: \"fa-train\",\r\n    color: pantonePalette[\"266\"],\r\n    selectedByDefault: false,\r\n  },\r\n  \"elizabeth-line\": {\r\n    label: \"Elizabeth Line\",\r\n    hidden: false,\r\n    icon: \"fa-subway\",\r\n    color: pantonePalette[\"266\"],\r\n    selectedByDefault: false,\r\n  },\r\n  tram: {\r\n    label: \"London Tramlink\",\r\n    color: pantonePalette[\"368\"],\r\n    icon: \"fa-subway\",\r\n    selectedByDefault: false,\r\n  },\r\n  tube: {\r\n    label: \"London Underground\",\r\n    color: pantonePalette[\"158\"],\r\n    icon: \"fa-subway\",\r\n    selectedByDefault: true,\r\n  },\r\n};\r\n\r\nexport const MODES_INFO = objectFilter(\r\n  MODES_INFO_ALL,\r\n  ({ hidden }: { hidden: boolean }) => !hidden,\r\n);\r\n\r\nexport const MODES_LABELS = objectMap(\r\n  MODES_INFO,\r\n  ({ label }: { label: string }) => label,\r\n);\r\n\r\nexport const MODES_DEFAULT = objectMap(\r\n  MODES_INFO,\r\n  ({ selectedByDefault }: { selectedByDefault: boolean }) =>\r\n    selectedByDefault || false,\r\n);\r\n\r\nconst LONDON_UNDERGROUND_LINE_COLORS = {\r\n  bakerloo: pantonePalette[\"470\"],\r\n  central: pantonePalette[\"485\"],\r\n  circle: pantonePalette[\"116\"],\r\n  piccadilly: pantonePalette[\"Blue 072\"],\r\n  district: pantonePalette[\"356\"],\r\n  \"waterloo-city\": pantonePalette[\"338\"],\r\n  \"hammersmith-city\": pantonePalette[\"197\"],\r\n  victoria: pantonePalette[\"299\"],\r\n  jubilee: pantonePalette[\"430\"],\r\n  metropolitan: pantonePalette[\"235\"],\r\n  northern: pantonePalette.Black,\r\n};\r\n\r\nconst NATIONAL_RAIL_LINE_COLORS = {\r\n  \"avanti-west-coast\": \"#AAAAAA\",\r\n  c2c: \"#AF8EC7\",\r\n  \"chiltern-railways\": \"#FB369B\",\r\n  \"cross-country\": \"#AAAAAA\",\r\n  \"east-midlands-railway\": \"#31B0CD\",\r\n  \"first-hull-trains\": \"#AAAAAA\",\r\n  \"first-transpennine-express\": \"#AAAAAA\",\r\n  \"gatwick-express\": \"#2C2E35\",\r\n  \"grand-central\": \"#AAAAAA\",\r\n  \"greater-anglia\": \"#7E93A8\",\r\n  \"great-northern\": \"#D49C60\",\r\n  \"great-western-railway\": \"#142A96\",\r\n  \"heathrow-express\": \"#5BCDC2\",\r\n  \"island-line\": \"#AAAAAA\",\r\n  \"london-north-eastern-railway\": \"#88C946\",\r\n  merseyrail: \"#AAAAAA\",\r\n  \"northern-rail\": \"#AAAAAA\",\r\n  scotrail: \"#AAAAAA\",\r\n  southeastern: \"#0174C0\",\r\n  southern: \"#00AB4F\",\r\n  \"south-western-railway\": \"#FF2E17\",\r\n  thameslink: \"#BC2373\",\r\n  \"transport-for-wales\": \"#AAAAAA\",\r\n  \"west-midlands-trains\": \"#AAAAAA\",\r\n};\r\n\r\nexport const LINE_COLORS: Record<string, string> = {\r\n  ...objectMap(MODES_INFO_ALL, ({ color }: { color: string }) => color),\r\n  ...NATIONAL_RAIL_LINE_COLORS,\r\n  ...LONDON_UNDERGROUND_LINE_COLORS,\r\n  // elizabeth: pantonePalette[\"266\"],\r\n  \"london-overground\": MODES_INFO_ALL.overground.color!,\r\n  \"tfl-rail\": MODES_INFO_ALL.tflrail.color!,\r\n};\r\n\r\nexport const TFL_API_URL_ROOT = \"https://api.tfl.gov.uk\";\r\n\r\nexport const NAPTAN_STOPTYPES = [\r\n  \"NaptanMetroStation\",\r\n  \"NaptanRailStation\",\r\n  \"NaptanBusCoachStation\",\r\n  \"NaptanPublicBusCoachTram\",\r\n  \"NaptanFerryPort\",\r\n];\r\n\r\nexport const GRAPH_NODE_SIZE = 2;\r\nexport const GRAPH_NODE_SIZE_POI = 3;\r\n\r\nexport const DEFAULT_RADIUS = 800;\r\n\r\n// export const DEFAULT_POSTCODE = \"SE1 6TG\"; // example location in API docs\r\n// export const DEFAULT_POSTCODE = \"SE1 9SG\"; // london bridge bus station\r\n// export const DEFAULT_POSTCODE = \"SW1A 2JR\"; // westminster tube station\r\n// export const DEFAULT_POSTCODE = \"E14 0AF\"; // poplar DLR station\r\n// export const DEFAULT_POSTCODE = \"E14 8AB\"; // westferry DLR station (has trains from West India Quay, but not to it)\r\n// export const DEFAULT_POSTCODE = \"EC2M 7PY\"; // liverpool street\r\n// export const DEFAULT_POSTCODE = \"CR0 2AF\"; // west croydon (trams)\r\n// export const DEFAULT_POSTCODE = \"W12 8EG\"; // goldhawk road (h&c, circle in parallel)\r\n// export const DEFAULT_POSTCODE = \"N1C 4TB\"; // KGX/STP\r\nexport const DEFAULT_POSTCODE = process.env.REACT_APP_DEFAULT_POSTCODE || \"\";\r\n\r\n// export const EDGE_TYPE = \"line\";\r\nexport const EDGE_TYPE = \"arrow\";\r\n","export default __webpack_public_path__ + \"static/media/tfl_roundel_no_text.7d150cf8.svg\";","import axios from 'axios';\r\nimport * as qs from 'querystring';\r\nimport * as xmlparser from 'fast-xml-parser';\r\n// @ts-ignore\r\nimport { retag } from 'trackernet-xml-retag';\r\n\r\nexport default class TfLAPI {\r\n    public appKey: string;\r\n    private readonly host: string = 'api.tfl.gov.uk';\r\n    private readonly port: number = 443;\r\n\r\n    constructor(appKey: string) {\r\n        this.appKey = appKey;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    protected async sendRequest(uri: string, params: any, method: string) {\r\n        let FullURL: string = `https://${this.host}:${this.port}${uri}?app_key=${this.appKey}`;\r\n\r\n        // Removed all undefined objects from params\r\n        Object.keys(params).forEach((key) => (params[key] === undefined ? delete params[key] : {}));\r\n\r\n        // If Parameters are passed then stringify them and update the request URL\r\n        if (params) FullURL = `${FullURL}&${qs.stringify(params)}`;\r\n\r\n        const fetch = await axios.get(FullURL, { headers: { Accept: 'application/json', 'cache-control': 'no-cache' } });\r\n        return fetch.data;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    protected async sendRequestTrackerNet(uri: string, method: string, reTag: boolean) {\r\n        // Fetch data and retag the XML if required\r\n        const fetch = await axios.get(`http://cloud.tfl.gov.uk/TrackerNet${uri}`, { headers: { Accept: 'application/xml', 'cache-control': 'no-cache' } });\r\n        let xmlData = fetch.data;\r\n\r\n        if (reTag) xmlData = retag.trackerNetRetag(xmlData);\r\n\r\n        // Convert XML to JS / JSON\r\n        const jsonObj = xmlparser.parse(xmlData, {\r\n            attributeNamePrefix: '',\r\n            ignoreAttributes: false\r\n        });\r\n\r\n        return jsonObj;\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    static objectToQuery(params: any): string {\r\n        return Object.keys(params)\r\n            .map((key) => key + '=' + params[key])\r\n            .join('&');\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    static arrayToCSV(arr: Array<string | number>) {\r\n        return arr.join(',');\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    static convertDate(oldDate: Date | undefined): string {\r\n        return oldDate?.toISOString().split('.')[0] + 'Z';\r\n    }\r\n\r\n    /**\r\n     * @ignore\r\n     */\r\n    static incidentsCheck(incidentsOnly: boolean): string {\r\n        return incidentsOnly ? '/IncidentsOnly' : '';\r\n    }\r\n}\r\n","import TfL from './interfaces/tfl';\r\nimport TfLAPI from './tfl';\r\n\r\nexport default class Line extends TfLAPI {\r\n    constructor(config: string) {\r\n        super(config);\r\n    }\r\n\r\n    /** Get all valid modes */\r\n    getModes(): Promise<Array<TfL['Mode']>> {\r\n        return this.sendRequest('/Line/Meta/Modes', {}, 'GET');\r\n    }\r\n\r\n    /** Gets a list of all severity codes */\r\n    getSeverityCodes(): Promise<Array<TfL['StatusSeverity']>> {\r\n        return this.sendRequest('/Line/Meta/Severity', {}, 'GET');\r\n    }\r\n\r\n    /** Gets a list of all disruption types */\r\n    getDisruptionCategories(): Promise<Array<TfL['Disruption']['category']>> {\r\n        return this.sendRequest('/Line/Meta/DisruptionCategories', {}, 'GET');\r\n    }\r\n\r\n    /** Gets a list of all service types */\r\n    getServiceTypes(): Promise<Array<'Regular' | 'Night'>> {\r\n        return this.sendRequest('/Line/Meta/ServiceTypes', {}, 'GET');\r\n    }\r\n\r\n    /** Gets a list of the stations that serve the given line id */\r\n    getAllStopPoints(line: string): Promise<Array<TfL['StopPoint']>> {\r\n        return this.sendRequest(`/Line/${line}/StopPoints`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets all lines that serve the given modes\r\n     * @param modes An array of modes e.g. tube, tram\r\n     */\r\n    getAllByModes(modes: Array<string>): Promise<Array<TfL['Line']>> {\r\n        return this.sendRequest(`/Line/Mode/${TfLAPI.arrayToCSV(modes)}`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets the line status of for given line ids e.g Minor Delays\r\n     * @param lines A list of line ids e.g. victoria, circle, N133\r\n     * @param detail Include details of the disruptions that are causing the line status including the affected stops and routes\r\n     * @param startDate\r\n     * @param endDate\r\n     */\r\n    getStatusByLine(lines: Array<string>, detail: boolean = false, startDate?: Date, endDate?: Date): Promise<Array<TfL['Line']>> {\r\n        if (!startDate || !endDate) {\r\n            return this.sendRequest(`/Line/${TfLAPI.arrayToCSV(lines)}/Status`, { detail }, 'GET');\r\n        } else {\r\n            return this.sendRequest(`/Line/${TfLAPI.arrayToCSV(lines)}/Status/${TfLAPI.convertDate(startDate)}/to/${TfLAPI.convertDate(endDate)}`, { detail }, 'GET');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the line status of for all lines for the given modes\r\n     * @param modes A comma-separated list of modes to filter by. e.g. tube,dlr\r\n     * @param detail Include details of the disruptions that are causing the line status including the affected stops and routes\r\n     * @param severityLevel If specified, ensures that only those line status(es) are returned within the lines that have disruptions with the matching severity level\r\n     */\r\n    getStatusByModes(modes: Array<string>, detail?: boolean, severityLevel?: string): Promise<Array<TfL['Line']>> {\r\n        return this.sendRequest(`/Line/Mode/${TfLAPI.arrayToCSV(modes)}/Status`, { detail, severityLevel }, 'GET');\r\n    }\r\n\r\n    /** Gets the timetable for a specified station on the give line with specified destination */\r\n    getTimetableFromTo(line: string, from: string, to: string): Promise<Array<TfL['TimetableResponse']>> {\r\n        return this.sendRequest(`/Line/${line}/Timetable/${from}/to/${to}`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets the inbound timetable for a specified station on the give line\r\n     *\r\n     * @param line Id of the line e.g. 'victoria'\r\n     * @param NaptanID Id of the stop (station naptan code e.g. 940GZZLUASL)\r\n     * @param direction What direction you want the timetable for. Leave blank for outbound or 'inbound'\r\n     */\r\n    getTimetableFromStation(line: string, NaPTANID: string, direction?: string): Promise<Array<TfL['TimetableResponse']>> {\r\n        return this.sendRequest(`/Line/${line}/Timetable/${NaPTANID}`, { direction }, 'GET');\r\n    }\r\n\r\n    /** Get the list of arrival predictions for given line ids based at the given stop\r\n     * @param ids list of line ids e.g. ['victoria','circle','N133']\r\n     * @param NaptanID Id of stop to get arrival predictions for (station naptan code e.g. 940GZZLUASL)\r\n     * @param direction Optional. The direction of travel. Can be inbound or outbound or all. Default: all\r\n     * @param destinationStationId Optional. Id of destination stop\r\n     */\r\n    getArrivalsByNaptan(ids: Array<string>, NaptanID: string, direction: string = 'all', destinationStationId?: string): Promise<Array<TfL['Prediction']>> {\r\n        return this.sendRequest(`/Line/${TfLAPI.arrayToCSV(ids)}/Arrivals/${NaptanID}`, { direction, destinationStationId }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Get disruptions for the given line ids\r\n     * @param ids list of line ids e.g. ['victoria','circle','N133']\r\n     */\r\n    getDistruptionsByID(ids: Array<string>): Promise<Array<TfL['Disruption']>> {\r\n        return this.sendRequest(`/Line/${TfLAPI.arrayToCSV(ids)}/Disruption`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Get all valid routes for all lines, including the name and id of the originating and terminating stops for each route.\r\n     * @param serviceTypes A comma seperated list of service types to filter on. Supported values: Regular, Night. Defaulted to 'Regular' if not specified\r\n     */\r\n    getAllValidRoutes(serviceTypes?: string): Promise<Array<TfL['Line']>> {\r\n        return this.sendRequest(`/Line/Route`, { serviceTypes }, 'GET');\r\n    }\r\n}\r\n","import TfLAPI from './tfl';\r\nimport TfL from './interfaces/tfl';\r\n\r\nexport default class StopPoint extends TfLAPI {\r\n    constructor(config: string) {\r\n        super(config);\r\n    }\r\n\r\n    /**\r\n     * Gets the list of available StopPoint additional information categories\r\n     */\r\n    getCategories(): Promise<Array<TfL['StopPointCategory']>> {\r\n        return this.sendRequest(`/StopPoint/Meta/Categories`, {}, 'GET');\r\n    }\r\n    /**\r\n     * Gets the list of available StopPoint types\r\n     */\r\n    getTypes(): Promise<Array<string>> {\r\n        return this.sendRequest(`/StopPoint/Meta/StopTypes`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets the list of available StopPoint modes\r\n     */\r\n    getModes(): Promise<Array<TfL['Mode']>> {\r\n        return this.sendRequest(`/StopPoint/Meta/Modes`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets a list of StopPoints corresponding to the given list of stop ids\r\n     * @param ids A list of stop point ids (station naptan code e.g. 940GZZLUASL).\r\n     * @param includeCrowdingData Include the crowding data (static). To Filter further use: /StopPoint/{ids}/Crowding/{line}\r\n     */\r\n    getByIDs(ids: Array<string>, includeCrowdingData: boolean = false): Promise<Array<TfL['StopPoint']> | TfL['StopPoint']> {\r\n        return this.sendRequest(`/StopPoint/${TfLAPI.arrayToCSV(ids)}`, { includeCrowdingData }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets all stop points of a given type\r\n     * @param types A list of valid stop types can be obtained from the StopPoint/meta/stoptypes endpoint\r\n     */\r\n    getAllByStopType(types: Array<string>): Promise<Array<TfL['StopPoint']>> {\r\n        return this.sendRequest(`/StopPoint/Type/${TfLAPI.arrayToCSV(types)}`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets the service types for a given Stop Point\r\n     * @param id\r\n     * @param lineIds\r\n     * @param modes\r\n     */\r\n    getServiceTypesByID(id: string, lineIds?: Array<string>, modes?: Array<string>): Promise<Array<TfL['LineServiceType']>> {\r\n        return this.sendRequest(`/StopPoint/ServiceTypes`, { id, lineIds, modes }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Search StopPoints by their common name. Will not return a valid NaPTAN for HUB\r\n     * @param name Name of station\r\n     * @param modes Eg. tfl, dlr\r\n     */\r\n    search(name: string, modes: string): Promise<TfL['SearchResponse']> {\r\n        return this.sendRequest(`/StopPoint/Search/${name}`, { modes }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Get all service arrivals\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     */\r\n    getStationArrivals(id: string): Promise<Array<TfL['Prediction']>> {\r\n        return this.sendRequest(`/StopPoint/${id}/Arrivals`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     * @param lineIds List of line ids e.g. tfl-rail, london-overground, thameslink\r\n     */\r\n    // getArrivalDepartures(id: string, lineIds: Array<string>) {\r\n    //     return this.sendRequest(`/StopPoint/${id}/ArrivalsDepartures`, { lineIds }, 'GET');\r\n    // }\r\n\r\n    /**\r\n     * Gets all disruptions for the specified StopPointId, plus disruptions for any child Naptan records it may have\r\n     * @param ids A list of StopPoint ids (station naptan code e.g. 940GZZLUAS)\r\n     * @param getFamily Specify true to return disruptions for entire family, or false to return disruptions for just this stop point. Defaults to false.\r\n     * @param includeRouteBlockedStops\r\n     * @param flattenResponse Specify true to associate all disruptions with parent stop point. (Only applicable when getFamily is true)\r\n     */\r\n    getDisruptionsByID(ids: Array<string>, getFamily: boolean, includeRouteBlockedStops: boolean, flattenResponse: boolean): Promise<Array<TfL['DisruptedPoint']>> {\r\n        return this.sendRequest(\r\n            `/StopPoint/${TfLAPI.arrayToCSV(ids)}/Disruption`,\r\n            {\r\n                getFamily,\r\n                includeRouteBlockedStops,\r\n                flattenResponse\r\n            },\r\n            'GET'\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Gets a distinct list of disrupted stop points for the given modes\r\n     * @param modes An array of modes e.g. ['tube', 'dlr']\r\n     * @param includeRouteBlockedStops\r\n     */\r\n    getDisruptionsByMode(modes: Array<string>, includeRouteBlockedStops: boolean): Promise<Array<TfL['DisruptedPoint']>> {\r\n        return this.sendRequest(`/StopPoint/Mode/${TfLAPI.arrayToCSV(modes)}/Disruption`, { includeRouteBlockedStops }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets Stop points that are reachable from a station/line combination\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     * @param lineID Line id of the line to filter by (e.g. victoria)\r\n     * @param serviceTypes List of service types to filter on. Supported values: Regular, Night. Defaulted to 'Regular'.\r\n     */\r\n    getReachableStationsByID(id: string, lineID: string, serviceTypes: Array<string> = ['Regular']): Promise<Array<TfL['Identifier']>> {\r\n        return this.sendRequest(`/StopPoint/${id}/CanReachOnLine/${lineID}`, { serviceTypes: TfLAPI.arrayToCSV(serviceTypes) }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Get the route sections for all the lines that service the given stop point id\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     * @param serviceTypes List of service types to filter on. Supported values: Regular, Night. Defaulted to 'Regular'.\r\n     */\r\n    getRouteSectionByID(id: string, serviceTypes: Array<string> = ['Regular']): Promise<Array<TfL['StopPointRouteSection']>> {\r\n        return this.sendRequest(`/StopPoint/${id}/  `, { serviceTypes: TfLAPI.arrayToCSV(serviceTypes) }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets a list of StopPoints within {radius} by the specified criteria\r\n     * @param stopTypes a list of stopTypes that should be returned.\r\n     * @param radius The radius of the bounding circle in metres (default : 200)\r\n     * @param useStopPointHierarchy Re-arrange the output into a parent/child hierarchy.\r\n     * @param modes The list of modes to search (e.g. tube, dlr)\r\n     * @param categories an optional list of comma separated property categories to return in the StopPoint's property bag. If null or empty, all categories of property are returned. Pass the keyword \"none\" to return no properties.\r\n     * @param returnLines True to return the lines that each stop point serves as a nested resource.\r\n     * @param latitude\r\n     * @param longitude\r\n     */\r\n    getInRadius(\r\n        stopTypes: Array<string>,\r\n        radius: number = 200,\r\n        useStopPointHierarchy: boolean,\r\n        modes: Array<string>,\r\n        categories: Array<string>,\r\n        returnLines: boolean,\r\n        latitude: number,\r\n        longitude: number\r\n    ): Promise<TfL['StopPointsResponse']> {\r\n        return this.sendRequest(\r\n            `/StopPoint`,\r\n            { stopTypes: TfLAPI.arrayToCSV(stopTypes), radius, useStopPointHierarchy, modes: TfLAPI.arrayToCSV(modes), categories: TfLAPI.arrayToCSV(categories), returnLines, lat: latitude, lon: longitude },\r\n            'GET'\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Gets a StopPoint for a given sms code.\r\n     * @param smsID A 5-digit Countdown Bus Stop Code e.g. 73241, 50435, 56334.\r\n     * @param output If set to \"web\", a 302 redirect to relevant website bus stop page is returned. All other values are ignored.\r\n     */\r\n    getBySMSCode(smsID: number, output?: string): Promise<TfL['StopPoint']> {\r\n        return this.sendRequest(`/StopPoint/Sms/${smsID}`, { output }, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Gets a list of taxi ranks corresponding to the given stop point id\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     */\r\n    getTaxiRanksByID(id: string): Promise<Array<TfL['Place']>> {\r\n        return this.sendRequest(`/StopPoint/${id}/TaxiRanks`, {}, 'GET');\r\n    }\r\n\r\n    /**\r\n     * Get car parks corresponding to the given stop point id\r\n     * @param id A StopPoint id (station naptan code e.g. 940GZZLUAS)\r\n     */\r\n    getCarParksByID(id: string): Promise<Array<TfL['Place']>> {\r\n        return this.sendRequest(`/StopPoint/${id}/CarParks`, {}, 'GET');\r\n    }\r\n}\r\n","const enum TrackerNetStations {\r\n    Amersham = 'AME',\r\n    ChalfontandLatimer = 'CLF',\r\n    Croxley = 'CRX',\r\n    Chorleywood = 'CWD',\r\n    EdgwareRoadBakerloo = 'ERB',\r\n    HarrowandWealdstone = 'HAW',\r\n    HarrowontheHill = 'HOH',\r\n    Harlesden = 'HSD',\r\n    KensalGreen = 'KGN',\r\n    Kenton = 'KNT',\r\n    KilburnPark = 'KPK',\r\n    LambethNorth = 'LAM',\r\n    MaidaVale = 'MDV',\r\n    MoorPark = 'MPK',\r\n    Marylebone = 'MYB',\r\n    NorthHarrow = 'NHR',\r\n    Northwood = 'NWD',\r\n    NorthwoodHills = 'NWH',\r\n    NorthWembley = 'NWM',\r\n    NorthwickPark = 'NWP',\r\n    Pinner = 'PIN',\r\n    QueensPark = 'QPK',\r\n    Rickmansworth = 'RKY',\r\n    RegentsPark = 'RPK',\r\n    SouthKenton = 'SKT',\r\n    StonebridgePark = 'SPK',\r\n    WarwickAvenue = 'WAR',\r\n    Watford = 'WAT',\r\n    WembleyCentral = 'WEM',\r\n    WestHarrow = 'WHR',\r\n    WillesdenJunction = 'WJN',\r\n    ActonTown = 'ACT',\r\n    ArnosGrove = 'AGR',\r\n    Aldgate = 'ALD',\r\n    AldgateEast = 'ALE',\r\n    Alperton = 'ALP',\r\n    Angel = 'ANG',\r\n    Archway = 'ARC',\r\n    Arsenal = 'ARL',\r\n    Balham = 'BAL',\r\n    Barbican = 'BAR',\r\n    BromleyByBow = 'BBB',\r\n    BaronsCourt = 'BCT',\r\n    Barkingside = 'BDE',\r\n    BondStreet = 'BDS',\r\n    Becontree = 'BEC',\r\n    Bermondsey = 'BER',\r\n    BoundsGreen = 'BGR',\r\n    BuckhurstHill = 'BHL',\r\n    BlackhorseRoad = 'BHR',\r\n    Barking = 'BKG',\r\n    Blackfriars = 'BLF',\r\n    BethnalGreen = 'BNG',\r\n    Bank = 'BNK',\r\n    Borough = 'BOR',\r\n    BostonManor = 'BOS',\r\n    BelsizePark = 'BPK',\r\n    Brixton = 'BRX',\r\n    BakerStreet = 'BST',\r\n    BrentCross = 'BTX',\r\n    BurntOak = 'BUR',\r\n    BowRoad = 'BWR',\r\n    Cockfosters = 'CFS',\r\n    ChalkFarm = 'CHF',\r\n    Chigwell = 'CHG',\r\n    ChiswickPark = 'CHP',\r\n    CharingCross = 'CHX',\r\n    ColliersWood = 'CLW',\r\n    CanningTown = 'CNT',\r\n    Colindale = 'COL',\r\n    CoventGarden = 'COV',\r\n    ClaphamCommon = 'CPC',\r\n    CanonsPark = 'CPK',\r\n    ClaphamNorth = 'CPN',\r\n    ClaphamSouth = 'CPS',\r\n    CaledonianRoad = 'CRD',\r\n    CannonStreet = 'CST',\r\n    CamdenTown = 'CTN',\r\n    CanaryWharf = 'CWF',\r\n    CanadaWater = 'CWR',\r\n    ChanceryLane = 'CYL',\r\n    Debden = 'DEB',\r\n    DagenhamEast = 'DGE',\r\n    DagenhamHeathway = 'DGH',\r\n    DollisHill = 'DHL',\r\n    EastActon = 'EAC',\r\n    EalingBroadway = 'EBY',\r\n    EalingCommon = 'ECM',\r\n    EarlsCourt = 'ECT',\r\n    Edgware = 'EDG',\r\n    EastFinchley = 'EFY',\r\n    EastHam = 'EHM ',\r\n    ElephantandCastle = 'ELE',\r\n    Embankment = 'EMB',\r\n    ElmPark = 'EPK',\r\n    Epping = 'EPP',\r\n    EastPutney = 'EPY',\r\n    EdgwareRoadHC = 'ERD',\r\n    EustonSquare = 'ESQ',\r\n    Eastcote = 'ETE',\r\n    Euston = 'EUS',\r\n    Farringdon = 'FAR',\r\n    FulhamBroadway = 'FBY',\r\n    Fairlop = 'FLP',\r\n    FinsburyPark = 'FPK',\r\n    FinchleyRoad = 'FRD',\r\n    FinchleyCentral = 'FYC',\r\n    Greenford = 'GFD',\r\n    GoldersGreen = 'GGR',\r\n    GantsHill = 'GHL',\r\n    GreenPark = 'GPK',\r\n    GreatPortlandStreet = 'GPS',\r\n    GloucesterRoad = 'GRD',\r\n    GrangeHill = 'GRH',\r\n    GoodgeStreet = 'GST',\r\n    Gunnersbury = 'GUN',\r\n    Hainault = 'HAI',\r\n    HighBarnet = 'HBT',\r\n    HighburyandIslington = 'HBY',\r\n    Hornchurch = 'HCH',\r\n    Hillingdon = 'HDN',\r\n    Highgate = 'HIG',\r\n    HangerLane = 'HLN',\r\n    HammersmithDistrictAndPicc = 'HMD',\r\n    Hampstead = 'HMP',\r\n    Hammersmith = 'HMS',\r\n    HounslowCentral = 'HNC',\r\n    HendonCentral = 'HND',\r\n    HounslowEast = 'HNE',\r\n    HounslowWest = 'HNW',\r\n    Holborn = 'HOL',\r\n    HydeParkCorner = 'HPC',\r\n    HollandPark = 'HPK',\r\n    HeathrowTerminals123 = 'HRC',\r\n    HollowayRoad = 'HRD',\r\n    HeathrowTerminal5 = 'HRV',\r\n    HighStreetKensington = 'HST',\r\n    HeathrowTerminal4 = 'HTF',\r\n    HattonCross = 'HTX',\r\n    Ickenham = 'ICK',\r\n    Kingsbury = 'KBY',\r\n    Kennington = 'KEN',\r\n    KewGardens = 'KEW',\r\n    Kilburn = 'KIL',\r\n    Knightsbridge = 'KNB',\r\n    KentishTown = 'KTN',\r\n    KingsCrossStPancras = 'KXX',\r\n    LancasterGate = 'LAN',\r\n    Leyton = 'LEY',\r\n    LondonBridge = 'LON',\r\n    LeicesterSquare = 'LSQ',\r\n    LiverpoolStreet = 'LST',\r\n    Loughton = 'LTN',\r\n    Leytonstone = 'LYS',\r\n    MansionHouse = 'MAN',\r\n    MarbleArch = 'MAR',\r\n    MorningtonCrescent = 'MCR',\r\n    Moorgate = 'MGT',\r\n    MillHillEast = 'MHE',\r\n    MileEnd = 'MLE',\r\n    ManorHouse = 'MNR',\r\n    Monument = 'MON',\r\n    Morden = 'MOR',\r\n    NorthActon = 'NAC',\r\n    Neasden = 'NEA',\r\n    NorthEaling = 'NEL',\r\n    NewburyPark = 'NEP',\r\n    Northfields = 'NFD',\r\n    NorthGreenwich = 'NGW',\r\n    NottingHillGate = 'NHG',\r\n    Northolt = 'NHT',\r\n    Oakwood = 'OAK',\r\n    OldStreet = 'OLD',\r\n    KensingtonOlympia = 'OLY',\r\n    Olympia = 'OLY',\r\n    Osterley = 'OST',\r\n    Oval = 'OVL',\r\n    OxfordCircus = 'OXC',\r\n    Paddington = 'PAD',\r\n    Perivale = 'PER',\r\n    ParsonsGreen = 'PGR',\r\n    PiccadillyCircus = 'PIC',\r\n    Pimlico = 'PIM',\r\n    Plaistow = 'PLW',\r\n    ParkRoyal = 'PRY',\r\n    PutneyBridge = 'PUT',\r\n    Queensbury = 'QBY',\r\n    Queensway = 'QWY',\r\n    RavenscourtPark = 'RCP',\r\n    Redbridge = 'RED',\r\n    RaynersLane = 'RLN',\r\n    Richmond = 'RMD',\r\n    RodingValley = 'ROD',\r\n    RussellSquare = 'RSQ',\r\n    RuislipGardens = 'RUG',\r\n    Ruislip = 'RUI',\r\n    RuislipManor = 'RUM',\r\n    ShepherdsBush = 'SBC',\r\n    SouthEaling = 'SEL',\r\n    Stratford = 'SFD',\r\n    Southfields = 'SFS',\r\n    Southgate = 'SGT',\r\n    SudburyHill = 'SHL',\r\n    SouthHarrow = 'SHR',\r\n    StJamesPark = 'SJP',\r\n    StJohnsWood = 'SJW',\r\n    SouthKensington = 'SKN',\r\n    Snaresbrook = 'SNB',\r\n    SouthRuislip = 'SRP',\r\n    SloaneSquare = 'SSQ',\r\n    Stanmore = 'STA',\r\n    StamfordBrook = 'STB',\r\n    StepneyGreen = 'STG',\r\n    Stockwell = 'STK',\r\n    SudburyTown = 'STN',\r\n    StPauls = 'STP',\r\n    SevenSisters = 'SVS',\r\n    SwissCottage = 'SWC',\r\n    SouthWoodford = 'SWF',\r\n    Southwark = 'SWK',\r\n    SouthWimbledon = 'SWM',\r\n    TootingBec = 'TBE',\r\n    TootingBroadway = 'TBY',\r\n    TottenhamCourtRoad = 'TCR',\r\n    Temple = 'TEM',\r\n    TurnhamGreen = 'TGR',\r\n    TheydonBois = 'THB',\r\n    TowerHill = 'THL',\r\n    TotteridgeandWhetstone = 'TOT',\r\n    TufnellPark = 'TPK',\r\n    TurnpikeLane = 'TPL',\r\n    TottenhamHale = 'TTH',\r\n    UpminsterBridge = 'UPB',\r\n    UptonPark = 'UPK',\r\n    Upminster = 'UPM',\r\n    Upney = 'UPY',\r\n    Uxbridge = 'UXB',\r\n    Victoria = 'VIC',\r\n    Vauxhall = 'VUX',\r\n    WestActon = 'WAC',\r\n    WalthamstowCentral = 'WAL',\r\n    Wanstead = 'WAN',\r\n    WestBrompton = 'WBT',\r\n    Whitechapel = 'WCL',\r\n    WhiteCity = 'WCT',\r\n    Wimbledon = 'WDN',\r\n    Woodford = 'WFD',\r\n    WestFinchley = 'WFY',\r\n    WoodGreen = 'WGN',\r\n    WestHampstead = 'WHD',\r\n    WestHam = 'WHM',\r\n    WestKensington = 'WKN',\r\n    WillesdenGreen = 'WLG',\r\n    Waterloo = 'WLO',\r\n    WimbledonPark = 'WMP',\r\n    Westminster = 'WMS',\r\n    WembleyPark = 'WPK',\r\n    WestRuislip = 'WRP',\r\n    WoodsidePark = 'WSP',\r\n    WarrenStreet = 'WST'\r\n}\r\n\r\nexport default TrackerNetStations;\r\n","const enum modes {\r\n    bus = 'bus',\r\n    cablecar = 'cable-car',\r\n    cycle = 'cycle',\r\n    cyclehire = 'cycle-hire',\r\n    dlr = 'dlr',\r\n    interchangekeepsitting = 'interchange-keep-sitting',\r\n    interchangesecure = 'interchange-secure',\r\n    nationalrail = 'national-rail',\r\n    overground = 'overground',\r\n    replacementbus = 'replacement-bus',\r\n    riverbus = 'river-bus',\r\n    rivertour = 'river-tour',\r\n    taxi = 'taxi',\r\n    tflrail = 'tflrail',\r\n    tram = 'tram',\r\n    tube = 'tube',\r\n    walking = 'walking'\r\n}\r\n\r\nexport default modes;\r\n","/* eslint-disable no-param-reassign */\r\n/* eslint-disable */\r\n// @ts-nocheck\r\nimport {\r\n  StopPoint as StopPointFunctions,\r\n  Line as LineFunctions,\r\n} from \"tfl-api-wrapper\";\r\nimport {\r\n  getDistanceFromLatLonInKm,\r\n  getUniqueListBy,\r\n  objectMap,\r\n  roundAccurately,\r\n  setIntersection,\r\n} from \"./utils\";\r\n\r\nimport { MODES_INFO_ALL, TFL_API_URL_ROOT } from \"./constants\";\r\nimport { components as StopPointComponents } from \"./types/StopPoint\";\r\nimport { components as LineComponents } from \"./types/Line\";\r\n\r\nimport postcodes from \"node-postcodes.io\";\r\n\r\ntype StopPoint = StopPointComponents[\"schemas\"][\"Tfl-11\"];\r\ntype Mode = LineComponents[\"schemas\"][\"Tfl\"];\r\n\r\nexport const getLatLonFromPostCode = async (\r\n  postcode: string,\r\n): Promise<LatLon> => {\r\n  let { result: res } = await postcodes.lookup(postcode);\r\n  if (res){\r\n    res = objectMap(res, (v: number) => roundAccurately(v, 3));\r\n    return [res.latitude, res.longitude];\r\n  }\r\n};\r\n\r\nexport const getPostCodeFromLatLon = async(\r\n  latLon: LatLon,\r\n) => {\r\n  let { result: res } = await postcodes.geo(...latLon, {limit: 1000});\r\n  if (res){\r\n    return res[0].postcode;\r\n  }\r\n}\r\n\r\nexport const getTFLApiKey = () => process.env.REACT_APP_TFL_KEY || \"\";\r\nconst stopPointInstance = new StopPointFunctions(getTFLApiKey());\r\nconst lineInstance = new LineFunctions(getTFLApiKey());\r\n\r\nexport const getModes = () => lineInstance.getModes();\r\nexport const getLinesByModes = (modeNames: string[]) =>\r\n  lineInstance.getAllByModes(modeNames);\r\n\r\nexport const getStopPointsInfo = (stopPointIds: string[]) =>\r\n  stopPointInstance.getByIDs(stopPointIds);\r\n\r\nconst getlineModeDictionary = async () => {\r\n  const lineModeDictionary = {};\r\n  const modes = await getModes();\r\n  let modeNames = modes.map(({ modeName }) => modeName);\r\n  // remove elizabeth line result while api does not support it\r\n  modeNames = modeNames.filter((modeName) => modeName !== \"elizabeth-line\");\r\n  const lines = await getLinesByModes(modeNames);\r\n  for (const line of lines) {\r\n    const { modeName: modeId, id: lineId, name: lineName } = line;\r\n    const modeName = MODES_INFO_ALL[modeId].label;\r\n    if (\r\n      lineId in lineModeDictionary &&\r\n      lineModeDictionary[lineId] !== modeId\r\n    ) {\r\n      console.warn(`line ${lineId} already corresponds to mode ${modeId}`);\r\n    } else {\r\n      lineModeDictionary[lineId] = {lineId, lineName, modeId, modeName};\r\n    }\r\n  }\r\n  return lineModeDictionary;\r\n};\r\n\r\nexport const lineModeDictionary = getlineModeDictionary();\r\n\r\nexport const makeTFLGetRequest = async (\r\n  route: string,\r\n  otherParams?: Record<string, any>,\r\n) => {\r\n  const appKey = getTFLApiKey();\r\n  const params = appKey\r\n    ? { app_key: appKey, ...otherParams }\r\n    : { ...otherParams };\r\n  const paramsString = new URLSearchParams(params).toString();\r\n  // console.log(`GET ${TFL_API_URL_ROOT}${route}?${params}`)\r\n  const response = await fetch(`${TFL_API_URL_ROOT}${route}?${paramsString}`);\r\n  if (response.ok) {\r\n    return response.json();\r\n  }\r\n  const { exceptionType, httpStatusCode, httpStatus, message } =\r\n    await response.json();\r\n  console.error(\r\n    `${exceptionType}: ${httpStatusCode} (${httpStatus})\\n${message} (from ${TFL_API_URL_ROOT}${route})`,\r\n  );\r\n  return null;\r\n};\r\n\r\nexport const getStopPointsByRadius = async (\r\n  stopTypes: string[],\r\n  latLong: [number, number],\r\n  radius: number,\r\n) => {\r\n  const [lat, lon] = latLong;\r\n\r\n  const res = await stopPointInstance.getInRadius(\r\n    stopTypes,\r\n    radius,\r\n    false,\r\n    [],\r\n    [],\r\n    true,\r\n    lat,\r\n    lon,\r\n  );\r\n\r\n  //   own implementation\r\n  // const res = await makeTFLGetRequest(\"/StopPoint\", {\r\n  //   stopTypes: stopTypes.join(),\r\n  //   lat,\r\n  //   lon,\r\n  //   radius,\r\n  //   returnLines: true,\r\n  // });\r\n\r\n  if (typeof res !== \"undefined\") return res.stopPoints as StopPoint[];\r\n  return [] as StopPoint[];\r\n};\r\n\r\nexport const getLinesFromModes = async (modesList: string[]) => {\r\n  const modesString = modesList.join(\",\");\r\n  const linesList = await makeTFLGetRequest(`/Line/Mode/${modesString}`);\r\n  return linesList;\r\n};\r\n\r\nexport const getRoutesOnLine = async (lineId: string) => {\r\n  const routeSequence = await makeTFLGetRequest(\r\n    `/Line/${lineId}/Route/Sequence/all`,\r\n  );\r\n  if (routeSequence === null) return null;\r\n  routeSequence.lineStrings = routeSequence.lineStrings.map(\r\n    (lineString: string) => JSON.parse(lineString)[0],\r\n  );\r\n  return routeSequence;\r\n};\r\n\r\nexport const getNaptanTypes = async () =>\r\n  makeTFLGetRequest(\"/StopPoint/Meta/StopTypes\");\r\n\r\nexport const getStoppointDataCategories = async () =>\r\n  makeTFLGetRequest(\"/StopPoint/Meta/categories\");\r\n\r\nexport const getTransportModes = async () => {\r\n  let res = await makeTFLGetRequest(\"/Line/Meta/Modes\");\r\n  res = res.filter((mode: Mode) => mode.isScheduledService);\r\n  res = Object.values(\r\n    objectMap(res, ({ modeName }: { modeName: string }) => modeName),\r\n  );\r\n  return res;\r\n};\r\n\r\nexport const filterStopPoints = async (\r\n  stopPoints: StopPoint[],\r\n  chosenModesSet: Set<string>,\r\n  topLevelKey: KeyOfType<StopPoint, string> | undefined,\r\n  origin: LatLon | undefined,\r\n) => {\r\n  // remove stopPoints with no line data\r\n  stopPoints = stopPoints.filter(\r\n    ({ lines }) => lines?.length && lines.length > 0,\r\n  );\r\n\r\n  // remove stopPoints that don't serve the chosen modes\r\n  if (typeof chosenModesSet !== \"undefined\") {\r\n    stopPoints = stopPoints.filter(\r\n      ({ modes }) => setIntersection(new Set(modes), chosenModesSet).size > 0,\r\n    );\r\n  }\r\n\r\n  // remove duplicate stopPoints\r\n  if (typeof topLevelKey === \"undefined\") {\r\n    return stopPoints;\r\n  }\r\n  // topLevelKey = \"stationNaptan\";\r\n  stopPoints = await Promise.all(\r\n    stopPoints.map(\r\n      async (stopPoint) =>\r\n        // makeTFLGetRequest(`/StopPoint/${stopPoint[topLevelKey]}`),\r\n        (await stopPointInstance.getByIDs([\r\n          stopPoint[topLevelKey],\r\n        ])) as StopPoint,\r\n    ),\r\n  );\r\n  stopPoints = stopPoints.map((stopPoint) => ({\r\n    ...stopPoint,\r\n    distance: !origin\r\n      ? -1 // TODO: check if StopPoint.distance can be undefined\r\n      : getDistanceFromLatLonInKm(origin, [stopPoint.lat, stopPoint.lon]),\r\n  }));\r\n  return getUniqueListBy(stopPoints, topLevelKey);\r\n};\r\n","import React, { createContext, useMemo, useState } from \"react\";\r\n\r\nexport const DEFAULT_MIN_BEDROOMS = 0;\r\nexport const DEFAULT_MAX_BEDROOMS = 2;\r\nexport const DEFAULT_MIN_PRICE = 0;\r\nexport const DEFAULT_MAX_PRICE = 1750;\r\nexport const DEFAULT_HOME_RADIUS_MILES = 0.5;\r\n\r\nexport const defaultFilterData = {\r\n  \"min-bedrooms\": DEFAULT_MIN_BEDROOMS,\r\n  \"max-bedrooms\": DEFAULT_MAX_BEDROOMS,\r\n  \"max-price\": DEFAULT_MAX_PRICE,\r\n  \"home-radius\": DEFAULT_HOME_RADIUS_MILES,\r\n};\r\n\r\nexport const MapContext = createContext();\r\n\r\nexport const MapProvider = ({ children }) => {\r\n  const [filterData, setFilterData] = useState(defaultFilterData);\r\n  return (\r\n    <MapContext.Provider value={useMemo(() => ({ filterData, setFilterData }))}>\r\n      {children}\r\n    </MapContext.Provider>\r\n  );\r\n};\r\n","/* eslint-disable @typescript-eslint/naming-convention */\r\nimport React, { useContext } from \"react\";\r\nimport {\r\n  // DEFAULT_MIN_PRICE,\r\n  MapContext,\r\n  // MapContext,\r\n} from \"./components/Map/MapContext\";\r\n\r\nconst outcodeData = require(\"./rightmoveOutcodeData.json\"); // https://github.com/ISNIT0/rightmove-outcode-scraper\r\n\r\nconst KM_PER_MILE = 1.609;\r\n\r\nconst getOnthemarketLink = ({ postcode }) => {\r\n  // ${DEFAULT_MIN_PRICE && `min-price=${DEFAULT_MIN_PRICE}`}\r\n  if (!postcode) return null;\r\n  const { filterData } = useContext(MapContext);\r\n  // eslint-disable-next-line prettier/prettier\r\n  const url = `https://www.onthemarket.com/to-rent/property/${postcode.toLowerCase().replace(\" \", \"-\")}/?furnished=furnished\r\nmax-bedrooms=${filterData[\"max-bedrooms\"]}\r\nmax-price=${filterData[\"max-price\"]}\r\nmin-bedrooms=${filterData[\"min-bedrooms\"]}\r\nradius=${filterData[\"home-radius\"]}\r\nview=grid`;\r\n  return url.replace(/(?:\\r\\n|\\r|\\n)/g, \"&\");\r\n};\r\n\r\nconst getOpenrentLink = ({ postcode }) => {\r\n  // prices_min=${DEFAULT_MIN_PRICE}\r\n  if (!postcode) return null;\r\n  const { filterData } = useContext(MapContext);\r\n  // eslint-disable-next-line prettier/prettier\r\n  const url = `https://www.openrent.co.uk/properties-to-rent/?term=${postcode}\r\narea=${filterData[\"home-radius\"] * KM_PER_MILE}\r\nprices_max=${filterData[\"max-price\"]}\r\nbedrooms_min=${filterData[\"min-bedrooms\"]}\r\nbedrooms_max=${filterData[\"max-bedrooms\"]}\r\nsearchType=km\r\nfurnishedType=1`;\r\n  return url.replace(/(?:\\r\\n|\\r|\\n)/g, \"&\");\r\n};\r\n\r\nconst getZooplaLink = ({ postcode }) => {\r\n  // price_min=${DEFAULT_MIN_PRICE}\r\n  if (!postcode) return null;\r\n  const { filterData } = useContext(MapContext);\r\n  const url = `https://www.zoopla.co.uk/search/?q=${postcode}\r\nbeds_min=${filterData[\"min-bedrooms\"]}\r\nbeds_max=${filterData[\"max-bedrooms\"]}\r\nprice_frequency=per_month\r\nprice_max=${filterData[\"max-price\"]}\r\nview_type=list\r\ncategory=residential\r\nsection=to-rent\r\nresults_sort=newest_listings\r\nsearch_source=home\r\nradius=${filterData[\"home-radius\"]}\r\nfurnished_state=furnished`;\r\n  return url.replace(/(?:\\r\\n|\\r|\\n)/g, \"&\");\r\n};\r\n\r\nconst getRightmoveLink = ({ postcode }) => {\r\n  if (!postcode) {\r\n    return null;\r\n  }\r\n  const outcode = postcode.split(\" \")[0];\r\n  const jsonInfo = outcodeData.find(\r\n    ({ outcode: jsonOutcode }) => jsonOutcode === outcode,\r\n  );\r\n  let codedOutcode;\r\n  if (jsonInfo) {\r\n    ({ code: codedOutcode } = jsonInfo);\r\n  } else {\r\n    return null;\r\n  }\r\n  // minPrice=${DEFAULT_MIN_PRICE}\r\n  const { filterData } = useContext(MapContext);\r\n  const url = `https://www.rightmove.co.uk/property-to-rent/find.html?\r\nsearchType=RENT\r\nlocationIdentifier=OUTCODE%5E${codedOutcode}\r\ninsId=1\r\nradius=0\r\nmaxPrice=${filterData[\"max-price\"]}\r\nminBedrooms=${filterData[\"min-bedrooms\"]}\r\nmaxBedrooms=${filterData[\"max-bedrooms\"]}\r\ndisplayPropertyType=\r\nmaxDaysSinceAdded=\r\nsortByPriceDescending=\r\nincludeLetAgreed=false\r\nprimaryDisplayPropertyType=\r\nsecondaryDisplayPropertyType=\r\noldDisplayPropertyType=\r\noldPrimaryDisplayPropertyType=\r\nletType=\r\nletFurnishType=furnished\r\nhouseFlatShare=\r\n`;\r\n  return url.replace(/(?:\\r\\n|\\r|\\n)/g, \"&\");\r\n};\r\n\r\nconst PropertyLink = ({ children, href }) =>\r\n  href && (\r\n    <a href={href} target=\"_blank\" rel=\"noopener noreferrer\">\r\n      {children}\r\n      <br />\r\n    </a>\r\n  );\r\n\r\nexport const OnthemarketLink = ({ postcode }) => (\r\n  <PropertyLink href={getOnthemarketLink({ postcode })}>\r\n    OnTheMarket\r\n  </PropertyLink>\r\n);\r\n\r\nexport const OpenrentLink = ({ postcode }) => (\r\n  <PropertyLink href={getOpenrentLink({ postcode })}>\r\n    OpenRent (min radius 2km)\r\n  </PropertyLink>\r\n);\r\n\r\nexport const RightmoveLink = ({ postcode }) => (\r\n  <PropertyLink href={getRightmoveLink({ postcode })}>\r\n    Rightmove (general area only)\r\n  </PropertyLink>\r\n);\r\n\r\nexport const ZooplaLink = ({ postcode }) => (\r\n  <PropertyLink href={getZooplaLink({ postcode })}>Zoopla</PropertyLink>\r\n);\r\n","/* eslint-disable react/no-array-index-key */\r\n/* eslint-disable no-restricted-syntax */\r\n/* eslint-disable no-underscore-dangle */\r\n/* eslint-disable @typescript-eslint/naming-convention */\r\n// /* eslint-disable prettier/prettier */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n// /* eslint-disable */\r\n\r\n// https://github.com/coryasilva/Leaflet.ExtraMarkers/issues/53#issuecomment-643551999\r\nimport L from \"leaflet\";\r\n\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\n\r\nimport {\r\n  MapContainer,\r\n  TileLayer,\r\n  Marker,\r\n  Popup,\r\n  useMap,\r\n  Circle,\r\n  Polyline,\r\n  CircleMarker,\r\n} from \"react-leaflet\";\r\nimport \"./Map.css\";\r\n\r\nimport \"leaflet-polylineoffset\";\r\nimport Graph from \"graphology\";\r\n// import * as ExtraMarkers from \"leaflet-extra-markers\"; // or else TS complains about the L extension\r\nimport \"@fortawesome/fontawesome-free/css/all.css\"; // e.g. using FA icons\r\nimport \"leaflet-extra-markers/dist/css/leaflet.extra-markers.min.css\"; // Do the L extension.\r\n\r\nimport { LINE_COLORS } from \"../../constants\";\r\nimport {\r\n  lineModeDictionary,\r\n  // getStopPointsInfo,\r\n  getPostCodeFromLatLon,\r\n} from \"../../api\";\r\n\r\nimport {\r\n  OnthemarketLink,\r\n  OpenrentLink,\r\n  RightmoveLink,\r\n  ZooplaLink,\r\n} from \"../../properties\";\r\nimport { MapContext, MapProvider } from \"./MapContext\";\r\n\r\n// import the LEM css\r\nrequire(\"leaflet-extra-markers\");\r\n\r\nconst TileLayerDefault = ({ attribution }) => (\r\n  <TileLayer\r\n    attribution={\r\n      // eslint-disable-next-line prettier/prettier\r\n    `&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors | ${attribution}`\r\n    }\r\n    url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n  />\r\n);\r\n\r\nconst TileLayerCustom = ({ styleId = \"jawg_streets\", attribution }) => (\r\n  <TileLayer\r\n    attribution={\r\n      // eslint-disable-next-line prettier/prettier\r\n      `<a href=\"https://www.jawg.io\" target=\"_blank\">&copy; Jawg</a> - <a href=\"https://www.openstreetmap.org\" target=\"_blank\">&copy; OpenStreetMap</a>&nbsp;contributors${attribution}`\r\n    }\r\n    url={`https://tile.jawg.io/${styleId}/{z}/{x}/{y}{r}.png?access-token=${process.env.REACT_APP_JAWG_KEY}`}\r\n  />\r\n);\r\n\r\nconst MapTileLayer = () => {\r\n  const [useCustomMap, setUseCustomMap] = useState(undefined);\r\n  if (!process.env.REACT_APP_JAWG_KEY) {\r\n    return <TileLayerDefault />;\r\n  }\r\n  const styleId = process.env.REACT_APP_JAWG_STYLE_ID || \"jawg-streets\";\r\n  const attribution = \"\";\r\n  useEffect(() => {\r\n    (async () => {\r\n      const response = await fetch(\r\n        `https://tile.jawg.io/${styleId}/13/4093/2723@2x.png?access-token=${process.env.REACT_APP_JAWG_KEY}`,\r\n      );\r\n      setUseCustomMap(!!response.ok);\r\n    })();\r\n  }, []);\r\n  return (\r\n    useCustomMap !== undefined &&\r\n    (useCustomMap ? (\r\n      <TileLayerCustom styleId={styleId} attribution={attribution} />\r\n    ) : (\r\n      <TileLayerDefault attribution={attribution} />\r\n    ))\r\n  );\r\n};\r\n\r\nconst originMarker = L.ExtraMarkers.icon({\r\n  icon: \"fa-building\",\r\n  markerColor: \"blue\",\r\n  shape: \"square\",\r\n  prefix: \"fa\",\r\n});\r\nconst stopPointIcon = (icon) =>\r\n  L.ExtraMarkers.icon({\r\n    icon,\r\n    markerColor: \"red\",\r\n    shape: \"square\",\r\n    prefix: \"fa\",\r\n  });\r\n\r\nconst getIconName = (modes) => {\r\n  const modesList = new Set(modes);\r\n  if (\r\n    modesList.has(\"tube\") ||\r\n    modesList.has(\"dlr\") ||\r\n    modesList.has(\"overground\") ||\r\n    modesList.has(\"tram\")\r\n  ) {\r\n    return \"fa-subway\";\r\n  }\r\n  if (modesList.has(\"national-rail\" || modesList.has(\"tfl-rail\"))) {\r\n    return \"fa-train\";\r\n  }\r\n  if (modesList.has(\"river-bus\")) {\r\n    return \"fa-ship\";\r\n  }\r\n  if (modesList.has(\"bus\")) {\r\n    return \"fa-bus\";\r\n  }\r\n  return \"fa-bus\"; // default\r\n};\r\n\r\nconst SetView = ({ latLong }) => {\r\n  const map = useMap();\r\n  map.setView(latLong, map.getZoom(), { animate: true });\r\n  return null;\r\n};\r\n\r\n// useEffect(() => {\r\n//   console.log(\"postcodeInfo UPDATED\");\r\n// }, [postcodeInfo]);\r\nconst formatLineModes = (lineModes) => {\r\n  let s = \"\";\r\n  for (const [mode, lines] of Object.entries(lineModes)) {\r\n    s += ` ${mode} lines:\\n`;\r\n    for (const line of lines) {\r\n      s += `  ${line}\\n`;\r\n    }\r\n  }\r\n  return s;\r\n};\r\n\r\nconst MapOriginMarkers = ({ originInfo }) =>\r\n  (originInfo && (\r\n    <>\r\n      <Marker position={originInfo.latLong} icon={originMarker}>\r\n        <Popup>\r\n          {originInfo.postcode} <br /> {JSON.stringify(originInfo.latLong)}\r\n        </Popup>\r\n      </Marker>\r\n      <SetView latLong={originInfo.latLong} />\r\n      <Circle center={originInfo.latLong} radius={originInfo.radius} />\r\n    </>\r\n  )) ||\r\n  null;\r\n\r\nconst MapNearbyStopPointMarkers = ({ nearbyStopPoints }) =>\r\n  nearbyStopPoints.map((stopPoint) => (\r\n    <Marker\r\n      position={[stopPoint.lat, stopPoint.lon]}\r\n      key={stopPoint.naptanId}\r\n      icon={stopPointIcon(getIconName(stopPoint.modes))}\r\n    >\r\n      <Popup>\r\n        {stopPoint.commonName}\r\n        <br />\r\n        Lines: {stopPoint.lines.map(({ name }) => name).join(\", \")}\r\n      </Popup>\r\n    </Marker>\r\n  ));\r\n\r\nconst MapLines = ({ mapLineSegments }) =>\r\n  (mapLineSegments &&\r\n    mapLineSegments.map((seg, i) => {\r\n      const lineWeight = 10;\r\n      const segmentWidth = seg.lineIds.length * lineWeight;\r\n      return (\r\n        <React.Fragment key={`pl-seg_${i}`}>\r\n          {seg.lineIds.map((lineId, j) => (\r\n            <Polyline\r\n              color={LINE_COLORS[lineId]}\r\n              opacity={0.75}\r\n              positions={seg.lineCoords}\r\n              offset={j * lineWeight - segmentWidth / 2 + lineWeight / 2}\r\n              key={`pl-seg_${i}-line_${j}_${lineId}`}\r\n              weight={lineWeight}\r\n              // lineCap={\"butt\"}\r\n            />\r\n          ))}\r\n        </React.Fragment>\r\n      );\r\n    })) ||\r\n  null;\r\n\r\nconst MapStation = ({ station }) => {\r\n  const [postcode, setPostcode] = useState(null);\r\n  useEffect(() => {\r\n    (async () => {\r\n      const _postcode = await station.postcode;\r\n      if (!_postcode) {\r\n        console.error(\r\n          `Could not get postcode for station ${station.label} (${station.coords}).`,\r\n        );\r\n      } else {\r\n        setPostcode(_postcode);\r\n      }\r\n    })();\r\n  }, []);\r\n  return (\r\n    <CircleMarker\r\n      center={station.coords}\r\n      radius={10}\r\n      color=\"#000\"\r\n      fillColor=\"#ccc\"\r\n      fillOpacity={0.5}\r\n      opacity={0.5}\r\n      weight={4}\r\n      eventHandlers={{\r\n        click: async () => {\r\n          // console.log(station);\r\n        },\r\n      }}\r\n    >\r\n      <Popup>\r\n        <div style={{ whiteSpace: \"pre\" }}>\r\n          {station.label}\r\n          <br />\r\n          {(postcode && `${postcode}, `) || \"[Unknown postcode], \"}\r\n          Zone {station.zone}\r\n          <br />\r\n          {formatLineModes(station.lineModes)}\r\n          <RightmoveLink postcode={postcode} />\r\n          <ZooplaLink postcode={postcode} />\r\n          <OpenrentLink postcode={postcode} />\r\n          <OnthemarketLink postcode={postcode} />\r\n        </div>\r\n      </Popup>\r\n    </CircleMarker>\r\n  );\r\n};\r\n\r\nconst MapStations = ({ stations }) =>\r\n  (stations &&\r\n    stations.map((station) => (\r\n      <MapStation station={station} key={station.label} />\r\n    ))) ||\r\n  null;\r\n\r\nconst Map = ({ originInfo, nearbyStopPoints, graphSerialized }) => {\r\n  const [mapLineSegments, setMapLineSegments] = useState();\r\n  const [stations, setStations] = useState();\r\n\r\n  useEffect(() => {\r\n    (async () => {\r\n      if (!graphSerialized) return;\r\n      const _displayedGraph = new Graph({ multi: true });\r\n      _displayedGraph.import(graphSerialized);\r\n      const _mapLineSegments = {};\r\n      _displayedGraph.forEachEdge((edge, { lineId }, fromNode, toNode) => {\r\n        const fromTo = [fromNode, toNode].sort().toString();\r\n        const { lat: fromLat, lon: fromLon } =\r\n          _displayedGraph.getNodeAttributes(fromNode);\r\n        const { lat: toLat, lon: toLon } =\r\n          _displayedGraph.getNodeAttributes(toNode);\r\n        if (!(fromTo in _mapLineSegments)) {\r\n          _mapLineSegments[fromTo] = {\r\n            lineCoords: [\r\n              [fromLat, fromLon],\r\n              [toLat, toLon],\r\n            ],\r\n            lineIds: [],\r\n          };\r\n        }\r\n        _mapLineSegments[fromTo].lineIds.push(lineId);\r\n      });\r\n      setMapLineSegments(Object.values(_mapLineSegments));\r\n      const lmd = await lineModeDictionary;\r\n      const _stations = [];\r\n      _displayedGraph.forEachNode((key, attributes) => {\r\n        const { lat, lon, lines, ...rest } = attributes;\r\n        const latLon = [lat, lon];\r\n        const postcode = getPostCodeFromLatLon(latLon);\r\n        const lineModes = {};\r\n        let modeName;\r\n        let lineName;\r\n        for (const { id } of lines) {\r\n          if (!(id in lmd)) {\r\n            modeName = \"[unknown mode]\";\r\n            lineName = id;\r\n            const info = `TFL did not return mode info for line \"${id}\" at station ${attributes.name}`;\r\n            console.error(info);\r\n            // toast.error(info, { id: info });\r\n          } else {\r\n            ({ modeName, lineName } = lmd[id]);\r\n          }\r\n          if (!(modeName in lineModes)) {\r\n            lineModes[modeName] = [];\r\n          }\r\n          lineModes[modeName].push(lineName);\r\n        }\r\n        _stations.push({ coords: latLon, postcode, lines, ...rest, lineModes });\r\n      });\r\n      setStations(_stations);\r\n    })();\r\n  }, [graphSerialized]);\r\n\r\n  return (\r\n    <MapContainer center={[51.505, -0.09]} zoom={13} scrollWheelZoom>\r\n      <MapTileLayer />\r\n      {/* <MapNearbyStopPointMarkers nearbyStopPoints={nearbyStopPoints} /> */}\r\n      <MapLines mapLineSegments={mapLineSegments} />\r\n      <MapStations stations={stations} />\r\n      <MapOriginMarkers originInfo={originInfo} />\r\n    </MapContainer>\r\n  );\r\n};\r\nexport default Map;\r\n","/* eslint-disable no-await-in-loop */\r\n/* eslint-disable no-restricted-syntax */\r\n/* eslint-disable */\r\nimport Graph from \"graphology\";\r\nimport { reverse } from \"graphology-operators\";\r\nimport React from \"react\";\r\nimport toast from \"react-hot-toast\";\r\nimport { SigmaContainer, useSigma } from \"react-sigma-v2/lib/esm\";\r\nimport \"react-sigma-v2/lib/react-sigma-v2.css\";\r\nimport { getLinesFromModes, getRoutesOnLine } from \"../api\";\r\nimport {\r\n  EDGE_TYPE,\r\n  GRAPH_NODE_SIZE,\r\n  LINE_COLORS,\r\n  MODES_INFO_ALL,\r\n} from \"../constants\";\r\nimport { objectKeysToList, objectMap, setUnion } from \"../utils\";\r\n\r\nconst defaultSigmaContainerStyle = { height: \"500px\", width: \"100%\" };\r\n\r\nexport const mergeGraph = (inputGraph: Graph, outputGraph: Graph, setAttributes: string[] = []) => {\r\n  if (typeof inputGraph !== \"undefined\") {\r\n    inputGraph.forEachNode((node, attributes) => {\r\n      for (const setName of setAttributes){\r\n        let currentAttribute = new Set();\r\n        if (outputGraph.hasNode(node)){\r\n          currentAttribute = outputGraph.getNodeAttribute(node, setName) || new Set();\r\n        }\r\n        const incomingAttribute = inputGraph.getNodeAttribute(node, setName) || new Set();\r\n        const newAttribute = setUnion(currentAttribute, incomingAttribute);\r\n        if (newAttribute.size > 0){\r\n          attributes[setName] = newAttribute;\r\n        }\r\n      }\r\n      outputGraph.mergeNode(node, attributes);\r\n    });\r\n    inputGraph.forEachEdge((edge, attributes, fromNode, toNode) => {\r\n      const [resKey, resEdgeAdded, resSrcNodeAdded, resTargetNodeAdded] =\r\n        outputGraph.mergeEdgeWithKey(edge, fromNode, toNode, attributes);\r\n    });\r\n  }\r\n};\r\n\r\nexport const mergeGraphList = (graphList: Graph[]) => {\r\n  const isMulti = graphList.map(({ multi }) => multi).some((v) => v);\r\n  const outputGraph = new Graph({ multi: isMulti });\r\n  for (const graph of graphList) {\r\n    mergeGraph(graph, outputGraph);\r\n  }\r\n  return outputGraph;\r\n};\r\n\r\nexport const mergeGraphObject = (graphObject: Record<string, Graph>) => {\r\n  const isMulti = Object.values(objectMap(graphObject, ({ multi }: { multi: boolean }) => multi)).some((v) => v);\r\n  const outputGraph = new Graph({ multi: isMulti });\r\n  for (const graph of Object.values(graphObject)) {\r\n    mergeGraph(graph, outputGraph);\r\n  }\r\n  return outputGraph;\r\n};\r\n\r\nconst GraphFunction = ({\r\n  graph,\r\n  resetOnChange = true,\r\n}: {\r\n  graph: Graph;\r\n  resetOnChange?: boolean;\r\n}) => {\r\n  const sigma = useSigma();\r\n  const sigmaGraph = sigma.getGraph();\r\n  if (resetOnChange) sigmaGraph.clear();\r\n  mergeGraph(graph, sigmaGraph);\r\n  return null;\r\n};\r\n\r\nexport const GraphComponent = ({\r\n  graph,\r\n  style,\r\n}: {\r\n  graph: Graph;\r\n  style: Record<string, any>;\r\n}) => (\r\n  <SigmaContainer\r\n    initialSettings={{ renderEdgeLabels: true }}\r\n    style={{ ...defaultSigmaContainerStyle, ...style }}\r\n  >\r\n    <GraphFunction graph={graph} />\r\n  </SigmaContainer>\r\n);\r\n\r\nexport const getLineGraphFromLine = async ({\r\n  lineId,\r\n  direction,\r\n  branchDataKey = \"stationId\",\r\n  multi = true,\r\n}: {\r\n  lineId: LineId;\r\n  direction: Direction;\r\n  branchDataKey?: string;\r\n  multi?: boolean;\r\n}) => {\r\n  const lineGraph = new Graph({multi});\r\n  const routeSequence = await getRoutesOnLine(lineId);\r\n  const lineName = routeSequence.lineName;\r\n  if (routeSequence === null) return lineGraph;\r\n  if (!routeSequence.stopPointSequences.length){\r\n    const info =`TFL returned no data for line \"${lineName}\". Data for this line may be missing or incomplete.`\r\n    console.error(info);\r\n    toast.error(info, { id: info })\r\n  }\r\n  const lineColor =\r\n    LINE_COLORS[routeSequence.lineId] ||\r\n    MODES_INFO_ALL[routeSequence.mode].color;\r\n  const { mode: modeName } = routeSequence\r\n  for (const stopPointSequence of routeSequence.stopPointSequences) {\r\n    if (stopPointSequence.direction === direction) {\r\n      const stopPointArray = stopPointSequence.stopPoint;    \r\n      for (let i = 0; i < stopPointArray.length - 1; i += 1) {\r\n        const spFrom = stopPointArray[i];\r\n        const spTo = stopPointArray[i + 1];\r\n        if (i === 0) {\r\n          lineGraph.mergeNode(spFrom[branchDataKey], {\r\n            ...spFrom,\r\n            x: spFrom.lon,\r\n            y: spFrom.lat,\r\n            label: spFrom.name,\r\n            color: lineColor,\r\n            size: GRAPH_NODE_SIZE,\r\n          });\r\n        }\r\n        lineGraph.mergeNode(spTo[branchDataKey], {\r\n          ...spTo,\r\n          x: spTo.lon,\r\n          y: spTo.lat,\r\n          label: spTo.name,\r\n          color: lineColor,\r\n          size: GRAPH_NODE_SIZE,\r\n        });\r\n        const fromTo = [spFrom[branchDataKey], spTo[branchDataKey]]\r\n        // fromTo.sort();\r\n        lineGraph.mergeEdgeWithKey(\r\n          JSON.stringify({lineId, fromTo}),\r\n          // `${lineId}|${fromTo}`,\r\n          fromTo[0],\r\n          fromTo[1],\r\n          {\r\n            lineId,\r\n            modeName,\r\n            type: EDGE_TYPE,\r\n            size: 2,\r\n            color: lineColor,\r\n            label: lineName,\r\n            direction,\r\n          },\r\n        );\r\n      }\r\n    }\r\n  }\r\n  return lineGraph;\r\n};\r\n\r\nexport const makeLineGraphUndirected = (inputGraph: Graph) => {\r\n  const outputGraph = new Graph({multi: inputGraph.multi})\r\n  inputGraph.forEachNode((node, attributes) => {\r\n    outputGraph.mergeNode(node, attributes);\r\n  });\r\n  inputGraph.forEachEdge((edge, attributes, fromNode, toNode) => {\r\n    const edgeJson = JSON.parse(edge)\r\n    const { fromTo } = edgeJson\r\n    fromTo.sort()\r\n    outputGraph.mergeEdgeWithKey(JSON.stringify(edgeJson), fromTo[0], fromTo[1], attributes);\r\n  });\r\n  return outputGraph;\r\n}\r\n\r\nexport const getLineGraphObjectFromLineIdList = async (\r\n  lineIdList: LineId[],\r\n  directionList: Direction[] = [\"outbound\"],\r\n  reverseGraph = false,\r\n  multi = true,\r\n) => {\r\n  const lineGraphObject: Record<LineId, Graph> = {};\r\n  for (const lineId of lineIdList) {\r\n    for (const direction of directionList) {\r\n      let lineGraph = await getLineGraphFromLine({ lineId, direction, multi });\r\n      if (reverseGraph) lineGraph = reverse(lineGraph);\r\n      // console.log(JSON.parse(JSON.stringify(lineGraph)));\r\n      lineGraphObject[lineId] = lineGraph;\r\n    }\r\n  }\r\n  return lineGraphObject;\r\n};\r\n\r\nexport const getLineGraphListFromLineIdList = async (\r\n  lineIdList: LineId[],\r\n  directionList: Direction[] = [\"outbound\"],\r\n) =>\r\n  Object.values(\r\n    await getLineGraphObjectFromLineIdList(lineIdList, directionList),\r\n  );\r\n\r\nexport const setGraphListFromChosenModes = async (\r\n  chosenModes: any,\r\n  graphListSetter: any,\r\n  directionList: Direction[] = [\"outbound\"],\r\n) => {\r\n  const modesList = objectKeysToList(chosenModes);\r\n  if (modesList.length === 0) return;\r\n  const lineGraphList = await getLineGraphListFromLineIdList(\r\n    (await getLinesFromModes(modesList)).map(({ id }: { id: any }) => id),\r\n    directionList,\r\n    // \"stationId\",\r\n  );\r\n  graphListSetter(lineGraphList);\r\n};\r\n","/* eslint-disable react/require-default-props */\r\n/* eslint-disable @typescript-eslint/no-shadow */\r\n/* eslint-disable no-param-reassign */\r\n/* eslint-disable react/jsx-no-useless-fragment */\r\n/* eslint-disable no-restricted-syntax */\r\n// https://github.com/mui-org/material-ui/issues/17407#issuecomment-969029758\r\nimport React from \"react\";\r\n\r\nimport ChevronRight from \"@mui/icons-material/ChevronRight\";\r\nimport ExpandMore from \"@mui/icons-material/ExpandMore\";\r\nimport TreeItem from \"@mui/lab/TreeItem\";\r\nimport TreeView from \"@mui/lab/TreeView\";\r\nimport Checkbox from \"@mui/material/Checkbox\";\r\nimport FormControlLabel from \"@mui/material/FormControlLabel\";\r\n\r\nconst VERBOSE = false;\r\n\r\n// Get all children from the current node.\r\nfunction getAllChild(childNode: RenderTree | null, collectedNodes: any[] = []) {\r\n  if (childNode === null) return collectedNodes;\r\n  collectedNodes.push(childNode.id);\r\n  if (Array.isArray(childNode.children)) {\r\n    for (const node of childNode.children) {\r\n      getAllChild(node, collectedNodes);\r\n    }\r\n  }\r\n  return collectedNodes;\r\n}\r\n\r\nfunction goThroughAllNodes(nodes: RenderTree, map: Record<string, any> = {}) {\r\n  if (!nodes.children) {\r\n    return null;\r\n  }\r\n  map[nodes.id] = getAllChild(nodes).splice(1);\r\n  for (const childNode of nodes.children) {\r\n    goThroughAllNodes(childNode, map);\r\n  }\r\n  return map;\r\n}\r\n\r\n// recursive DFS\r\nfunction getNodeById(node: RenderTree, id: string, parentsPath: string[]): any {\r\n  let result = null;\r\n  if (node.id === id) {\r\n    return node;\r\n  }\r\n  if (Array.isArray(node.children)) {\r\n    for (const childNode of node.children) {\r\n      result = getNodeById(childNode, id, parentsPath);\r\n      if (result) {\r\n        parentsPath.push(node.id);\r\n        return result;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  return result;\r\n}\r\n\r\nconst getChildById = (nodes: RenderTree, id: string) => {\r\n  const array: string[] = [];\r\n  const path: string[] = [];\r\n\r\n  const nodeToToggle = getNodeById(nodes, id, path);\r\n  // console.log(path);\r\n  return { childNodesToToggle: getAllChild(nodeToToggle, array), path };\r\n};\r\n\r\nexport default ({\r\n  data,\r\n  stateGetter,\r\n  stateSetter,\r\n  defaultExpanded = [],\r\n}: {\r\n  data: RenderTree;\r\n  stateGetter: string[];\r\n  stateSetter: UseStateSetter<string[]>;\r\n  defaultExpanded?: string[];\r\n}) => {\r\n  // const [selected, setSelected] = React.useState<string[]>([]);\r\n  if (VERBOSE) console.log(stateGetter);\r\n  const selectedSet = React.useMemo(() => new Set(stateGetter), [stateGetter]);\r\n  const parentMap = React.useMemo(() => goThroughAllNodes(data), []);\r\n  // console.log(\"parentMap\", parentMap);\r\n\r\n  function getOnChange(checked: boolean, nodes: RenderTree) {\r\n    const { childNodesToToggle, path } = getChildById(data, nodes.id);\r\n    if (VERBOSE)\r\n      console.log(\"childNodesToChange\", { childNodesToToggle, checked });\r\n    let array = checked\r\n      ? [...stateGetter, ...childNodesToToggle]\r\n      : stateGetter\r\n          .filter((value) => !childNodesToToggle.includes(value))\r\n          .filter((value) => !path.includes(value));\r\n    array = array.filter((v, i) => array.indexOf(v) === i);\r\n    stateSetter(array);\r\n  }\r\n\r\n  const renderTree = (nodes: RenderTree) => {\r\n    const allSelectedChildren = parentMap?.[nodes.id]?.every(\r\n      (childNodeId: string) => selectedSet.has(childNodeId),\r\n    );\r\n    const checked = selectedSet.has(nodes.id) || allSelectedChildren || false;\r\n\r\n    const indeterminate =\r\n      parentMap?.[nodes.id]?.some((childNodeId: string) =>\r\n        selectedSet.has(childNodeId),\r\n      ) || false;\r\n\r\n    if (allSelectedChildren && !selectedSet.has(nodes.id)) {\r\n      if (VERBOSE) console.log(\"if allSelectedChildren\");\r\n      stateSetter([...stateGetter, nodes.id]);\r\n    }\r\n\r\n    return (\r\n      <TreeItem\r\n        key={nodes.id}\r\n        nodeId={nodes.id}\r\n        label={\r\n          <FormControlLabel\r\n            control={\r\n              <Checkbox\r\n                checked={checked}\r\n                indeterminate={!checked && indeterminate}\r\n                onChange={(event) =>\r\n                  getOnChange(event.currentTarget.checked, nodes)\r\n                }\r\n                onClick={(e) => e.stopPropagation()}\r\n              />\r\n            }\r\n            label={<>{nodes.name}</>}\r\n            key={nodes.id}\r\n          />\r\n        }\r\n      >\r\n        {Array.isArray(nodes.children)\r\n          ? nodes.children.map((node) => renderTree(node))\r\n          : null}\r\n      </TreeItem>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <TreeView\r\n      defaultExpanded={defaultExpanded}\r\n      defaultExpandIcon={<ChevronRight />}\r\n      defaultCollapseIcon={<ExpandMore />}\r\n      style={{ textAlign: \"initial\" }}\r\n    >\r\n      {renderTree(data)}\r\n    </TreeView>\r\n  );\r\n};\r\n","/* eslint-disable no-restricted-syntax */\r\n/* eslint-disable no-await-in-loop */\r\n// @ts-nocheck\r\nimport React, { useEffect, useState } from \"react\";\r\n\r\nimport { MODES_DEFAULT, MODES_INFO_ALL } from \"../constants\";\r\nimport CheckBoxTreeView from \"./CheckBoxTreeView\";\r\nimport { components as LineComponents } from \"../types/Line\";\r\nimport { catchHttpError } from \"../utils\";\r\nimport { getModes, getLinesByModes } from \"../api\";\r\n\r\ntype Mode = LineComponents[\"schemas\"][\"Tfl\"];\r\ntype Line = LineComponents[\"schemas\"][\"Tfl-19\"];\r\n\r\n// const linesToModes = {};\r\n// {\r\n//   const modes = await getModes();\r\n//   let modeNames = modes.map(({ modeName }) => modeName);\r\n//   // remove elizabeth line result while api does not support it\r\n//   modeNames = modeNames.filter((modeName) => modeName !== \"elizabeth-line\");\r\n//   const lines = await getLinesByModes(modeNames);\r\n//   for (const { modeName, id: lineId } of lines) {\r\n//     if (lineId in linesToModes && linesToModes[lineId] !== modeName) {\r\n//       console.warn(`line ${lineId} already corresponds to mode ${modeName}`);\r\n//     } else {\r\n//       linesToModes[lineId] = modeName;\r\n//     }\r\n//   }\r\n// }\r\n// export { linesToModes };\r\n\r\nconst ModeCheckList = ({\r\n  stateGetter,\r\n  stateSetter,\r\n}: {\r\n  stateGetter: string[];\r\n  stateSetter: UseStateSetter<string[]>;\r\n}) => {\r\n  const useLines = false;\r\n\r\n  const parentId = \"parent:all\";\r\n  const parentLabel = \"All Modes\";\r\n\r\n  const [data, setData] = useState<RenderTree | undefined>();\r\n  // const defaultExpanded = [parentId];\r\n  const defaultExpanded: string[] = [];\r\n  useEffect(() => {\r\n    (async () => {\r\n      const modeLineTree: RenderTree = {\r\n        id: parentId,\r\n        name: parentLabel,\r\n        children: [],\r\n      };\r\n      let modes: Mode[] = [];\r\n\r\n      modes = (await catchHttpError(getModes)()) as unknown as Mode[];\r\n      const modeNames = modes\r\n        .filter(\r\n          (mode) =>\r\n            mode.isScheduledService &&\r\n            mode.isFarePaying &&\r\n            (mode.isTflService || mode.modeName === \"national-rail\"),\r\n        )\r\n        .map(({ modeName }) => modeName)\r\n        .filter(\r\n          (modeName) =>\r\n            MODES_INFO_ALL[modeName] && !MODES_INFO_ALL[modeName].hidden,\r\n        );\r\n\r\n      const chosenByDefault = modeNames.filter(\r\n        (modeName) => MODES_DEFAULT[modeName],\r\n      );\r\n      stateSetter(chosenByDefault);\r\n\r\n      const children: RenderTree[] = [];\r\n      for (const modeName of modeNames) {\r\n        const child: RenderTree = {\r\n          id: modeName,\r\n          name: MODES_INFO_ALL[modeName].label || modeName,\r\n        };\r\n        if (useLines) {\r\n          const grandchildren = (\r\n            (await getLinesByModes([modeName])) as Line[]\r\n          ).map(({ id, name }) => ({\r\n            id,\r\n            name,\r\n          }));\r\n          child.children = grandchildren;\r\n        }\r\n        children.push(child);\r\n      }\r\n      modeLineTree.children = children;\r\n\r\n      setData(modeLineTree);\r\n    })();\r\n  }, []);\r\n\r\n  if (data!) {\r\n    return (\r\n      <CheckBoxTreeView\r\n        data={data}\r\n        stateGetter={stateGetter}\r\n        stateSetter={stateSetter}\r\n        defaultExpanded={defaultExpanded}\r\n      />\r\n    );\r\n  }\r\n  return <>Loading mode checklist...</>;\r\n};\r\nexport default ModeCheckList;\r\n","/* eslint no-plusplus: [\"error\", { \"allowForLoopAfterthoughts\": true }] */\r\n/* eslint-disable func-names */\r\n/* eslint-disable no-underscore-dangle */\r\n/* eslint-disable @typescript-eslint/naming-convention */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n/* eslint-disable object-curly-newline */\r\n/* eslint-disable max-len */\r\n/* eslint-disable guard-for-in */\r\n/* eslint-disable no-await-in-loop */\r\n/* eslint-disable no-restricted-syntax */\r\n/* eslint-disable no-param-reassign */\r\n// /* eslint-disable */\r\n// @ts-nocheck\r\nimport React, { useState, useEffect, useCallback, useContext } from \"react\";\r\n// import React, { useState } from \"react\";\r\n// import Button from \"react-bootstrap/Button\";\r\nimport toast, { Toaster } from \"react-hot-toast\";\r\n\r\nimport Graph from \"graphology\";\r\nimport { dfsFromNode } from \"graphology-traversal/dfs\";\r\nimport subgraph from \"graphology-operators/subgraph\";\r\nimport reverse from \"graphology-operators/reverse\";\r\n\r\nimport Button from \"@mui/material/Button\";\r\nimport InputAdornment from \"@mui/material/InputAdornment\";\r\nimport Container from \"@mui/material/Container\";\r\nimport Typography from \"@mui/material/Typography\";\r\nimport TextField from \"@mui/material/TextField\";\r\n// import Box from \"@mui/material/Box\";\r\nimport Paper from \"@mui/material/Paper\";\r\n// import Stack from \"@mui/material/Stack\";\r\nimport Grid from \"@mui/material/Grid\";\r\n\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport {\r\n  NAPTAN_STOPTYPES,\r\n  DEFAULT_POSTCODE,\r\n  DEFAULT_RADIUS,\r\n  LINE_COLORS,\r\n  // GRAPH_NODE_SIZE_POI,\r\n} from \"../../constants\";\r\n\r\n// import logo from './logo.svg';\r\nimport logo from \"../../tfl_roundel_no_text.svg\";\r\nimport \"./App.css\";\r\nimport {\r\n  mapArrayOfKeysToObject,\r\n  objectFilter,\r\n  setNestedObject,\r\n} from \"../../utils\";\r\nimport Map from \"../Map/Map\";\r\n\r\nimport {\r\n  getLatLonFromPostCode,\r\n  getStopPointsByRadius,\r\n  filterStopPoints,\r\n  // lineModeDictionary,\r\n} from \"../../api\";\r\n\r\nimport {\r\n  getLineGraphObjectFromLineIdList,\r\n  // GraphComponent,\r\n  mergeGraphObject,\r\n  mergeGraph,\r\n  makeLineGraphUndirected,\r\n} from \"../Graphs\";\r\n\r\nimport { components as StopPointComponents } from \"../../types/StopPoint\";\r\nimport { components as LineComponents } from \"../../types/Line\";\r\nimport ModeCheckList from \"../ModeCheckList\";\r\n\r\nimport {\r\n  DEFAULT_MAX_BEDROOMS,\r\n  DEFAULT_MIN_BEDROOMS,\r\n  DEFAULT_HOME_RADIUS_MILES,\r\n  DEFAULT_MAX_PRICE,\r\n} from \"../../properties\";\r\nimport { defaultFilterData, MapContext } from \"../Map/MapContext\";\r\n\r\n// type LineModeGroup = StopPointComponents[\"schemas\"][\"Tfl-8\"];\r\ntype StopPoint = StopPointComponents[\"schemas\"][\"Tfl-11\"];\r\ntype MatchedStop = LineComponents[\"schemas\"][\"Tfl-20\"];\r\n\r\nconst mergeStopPoint = (\r\n  graph: Graph,\r\n  stopPoint: MatchedStop,\r\n  lineName: string,\r\n) => {\r\n  const branchDataKey = \"stationId\";\r\n  graph.mergeNode(stopPoint[branchDataKey], {\r\n    ...stopPoint,\r\n    x: stopPoint.lon,\r\n    y: stopPoint.lat,\r\n    label: stopPoint.name,\r\n    color: LINE_COLORS[lineName],\r\n  });\r\n};\r\n\r\nconst withToast = (fn: any, info: any, show = true) =>\r\n  async function (...args: any[]) {\r\n    const promise = fn(...args);\r\n    if (show) {\r\n      toast.promise(promise, {\r\n        loading: info,\r\n        success: info,\r\n        error: info,\r\n      });\r\n    }\r\n    return promise;\r\n  };\r\n\r\nconst handleKeyDown = (e) => {\r\n  if (e.key === \"Enter\" || e.key === \"Escape\") {\r\n    if (e.key === \"Enter\") {\r\n      const { form } = e.target;\r\n      const index = [...form].indexOf(e.target);\r\n      for (let i = index + 1; i < form.length; i++) {\r\n        const element = form.elements[i];\r\n        if (element.localName === \"input\") {\r\n          element.focus();\r\n          break;\r\n        }\r\n      }\r\n      e.preventDefault();\r\n    } else {\r\n      e.target.blur();\r\n    }\r\n  }\r\n};\r\n\r\nconst TextInputCustom = ({\r\n  name,\r\n  label,\r\n  dataObject,\r\n  handleFormChange,\r\n  error,\r\n}) => (\r\n  <TextField\r\n    id={`input-${name}`}\r\n    name={name}\r\n    label={label || name}\r\n    variant=\"outlined\"\r\n    defaultValue={dataObject[name]}\r\n    onBlur={handleFormChange}\r\n    onKeyDown={handleKeyDown}\r\n    error={error || false}\r\n  />\r\n);\r\n\r\nconst NumInputCustom = ({\r\n  name,\r\n  label,\r\n  dataObject,\r\n  handleNumChange,\r\n  adornment,\r\n  error,\r\n  float = false,\r\n}) => (\r\n  <TextField\r\n    id={`input-${name}`}\r\n    name={name}\r\n    label={label || name}\r\n    variant=\"outlined\"\r\n    value={dataObject[name]}\r\n    onChange={(e) => handleNumChange(e, float)}\r\n    onKeyDown={handleKeyDown}\r\n    InputProps={\r\n      adornment\r\n        ? {\r\n            [`${adornment.type}Adornment`]: (\r\n              <InputAdornment position={adornment.type}>\r\n                {adornment.text}\r\n              </InputAdornment>\r\n            ),\r\n          }\r\n        : null\r\n    }\r\n    error={error || false}\r\n  />\r\n);\r\n\r\nconst App = () => {\r\n  const [info, setInfo] = useState(\"Waiting for search...\");\r\n  const [isBusy, setBusy] = useState(true);\r\n\r\n  // const [formData[\"destination-postcode\"], setPostcode] = useState(DEFAULT_POSTCODE);\r\n  // const [formData[\"destination-radius\"], setRadius] = useState(DEFAULT_RADIUS);\r\n\r\n  const [displayedGraph, setDisplayedGraph] = useState(new Graph());\r\n  // const [reverseGraph, setReverseGraph] = useState(true);\r\n  // const reverseGraph = false;\r\n\r\n  // map data\r\n  const [originInfo, setOriginInfo] =\r\n    useState<{ postcode: string; latLong: LatLon; radius: number }>();\r\n  const [nearbyStopPoints, setNearbyStopPoints] = useState<StopPoint[]>([]);\r\n  const [graphSerialized, setGraphSerialized] = useState<any>();\r\n\r\n  const [getModeCheckList, setModeCheckList] = useState<string[]>([]);\r\n\r\n  const defaultFormData = {\r\n    \"destination-postcode\": DEFAULT_POSTCODE,\r\n    \"destination-radius\": DEFAULT_RADIUS,\r\n  };\r\n\r\n  const [formData, setFormData] = useState(defaultFormData);\r\n  // const [filterData, setFilterData] = useState(defaultFilterData);\r\n  const { filterData, setFilterData } = useContext(MapContext);\r\n\r\n  useEffect(() => {\r\n    // (async () => {\r\n    // })();\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const params = Object.fromEntries(urlParams);\r\n    const _formData = objectFilter(params, (v, k) => k in defaultFormData);\r\n    const _filterData = objectFilter(params, (v, k) => k in defaultFilterData);\r\n    setFormData({ ...formData, ..._formData });\r\n    setFilterData({ ...filterData, ..._filterData });\r\n    setBusy(false);\r\n  }, []);\r\n\r\n  const handleFormChange = (e, value = null) => {\r\n    const cnd = e.target.name in defaultFormData;\r\n    const setFn = cnd ? setFormData : setFilterData;\r\n    const dataObject = cnd ? formData : filterData;\r\n    setFn({\r\n      ...dataObject,\r\n      [e.target.name]: value !== null ? value : e.target.value,\r\n    });\r\n  };\r\n\r\n  const handleNumChange = (e, allowFloat = false) => {\r\n    // https://stackoverflow.com/a/43177957\r\n\r\n    // pattern = '[0-9]*\\.?[0-9]*'\r\n    const pattern = allowFloat ? /[^0-9.]/g : /[^0-9]/g;\r\n    const onlyInts = e.target.value.replace(pattern, \"\");\r\n    handleFormChange(e, onlyInts);\r\n    // setFormData({ ...formData, [e.target.name]: onlyInts });\r\n  };\r\n\r\n  const updateUrl = () => {\r\n    const queryString = new URLSearchParams({\r\n      ...formData,\r\n      ...filterData,\r\n    }).toString();\r\n    window.history.pushState({}, \"\", `?${queryString}`);\r\n  };\r\n\r\n  const handleButtonClick = async (e) => {\r\n    e.preventDefault();\r\n    updateUrl();\r\n\r\n    // return;\r\n\r\n    let _info;\r\n    const toastId = \"toast\";\r\n\r\n    // convert postcode to latitude, longitude\r\n    _info = `Getting latitude/longitude of postcode ${formData[\"destination-postcode\"]}...`;\r\n    setInfo(_info);\r\n    toast.loading(_info, { id: toastId });\r\n    const latLong = await getLatLonFromPostCode(\r\n      formData[\"destination-postcode\"],\r\n    );\r\n    if (latLong) {\r\n      toast.success(_info, { id: toastId });\r\n    } else {\r\n      _info = `Postcode \"${formData[\"destination-postcode\"]}\" not found`;\r\n      setInfo(_info);\r\n      toast.error(_info, { id: toastId });\r\n      return;\r\n    }\r\n\r\n    setOriginInfo({\r\n      postcode: formData[\"destination-postcode\"],\r\n      latLong,\r\n      radius: formData[\"destination-radius\"],\r\n    });\r\n\r\n    // get list of stopPoints within radius\r\n    _info = `Searching for stops within ${\r\n      formData[\"destination-radius\"]\r\n    } metres of ${formData[\"destination-postcode\"]} (${JSON.stringify(\r\n      latLong,\r\n    )})...`;\r\n    setInfo(_info);\r\n    toast.loading(_info, { id: toastId });\r\n    let stopPoints = await getStopPointsByRadius(\r\n      NAPTAN_STOPTYPES,\r\n      latLong,\r\n      formData[\"destination-radius\"],\r\n    );\r\n    toast.success(_info, { id: toastId });\r\n    // console.log(JSON.parse(JSON.stringify({ stopPoints })));\r\n\r\n    // check for no result\r\n    if (stopPoints.length === 0) {\r\n      setInfo(\r\n        `No stops found within ${formData[\"destination-radius\"]} metres of postcode ${formData[\"destination-postcode\"]}`,\r\n      );\r\n      return;\r\n    }\r\n\r\n    const chosenModesSet = new Set(getModeCheckList);\r\n    stopPoints = await filterStopPoints(\r\n      stopPoints,\r\n      chosenModesSet,\r\n      undefined,\r\n      undefined,\r\n    );\r\n    setNearbyStopPoints(stopPoints);\r\n\r\n    const summary = stopPoints.map(({ commonName, distance }) => ({\r\n      commonName,\r\n      distance: typeof distance !== \"undefined\" ? Math.round(distance) : \"???\",\r\n    }));\r\n    summary.sort((a, b) => (a.distance > b.distance ? 1 : -1));\r\n    const summaryText = summary.map(\r\n      ({ commonName, distance }) => `${commonName} (${distance}m)`,\r\n    );\r\n    setInfo(\r\n      `Stops within ${formData[\"destination-radius\"]} metres of postcode ${\r\n        formData[\"destination-postcode\"]\r\n      } (${JSON.stringify(latLong)}): ${summaryText.join(\", \")}`,\r\n    );\r\n\r\n    _info = \"Plotting map...\";\r\n    toast.loading(_info, { id: toastId });\r\n    // organise the nearby stopPoints by mode and line; {mode: {line: [stopPoint]}}\r\n    const nearbyLineIdList: string[] = [];\r\n    const nearbyStopPointsOnLines: Record<\r\n      ModeId,\r\n      Record<LineId, StopPoint[]>\r\n    > = {};\r\n    for (const stopPoint of stopPoints) {\r\n      for (const { modeName, lineIdentifier } of stopPoint.lineModeGroups) {\r\n        if (chosenModesSet.has(modeName)) {\r\n          for (const line of lineIdentifier) {\r\n            if (\r\n              typeof nearbyStopPointsOnLines?.[modeName]?.[line] === \"undefined\"\r\n            ) {\r\n              setNestedObject(nearbyStopPointsOnLines, [modeName, line], []);\r\n              nearbyLineIdList.push(line);\r\n            }\r\n            nearbyStopPointsOnLines[modeName][line].push(stopPoint);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    const multi = true;\r\n    // const directions: Direction[] = [\"outbound\"];\r\n    // const directions: Direction[] = [\"inbound\"];\r\n    const directions: Direction[] = [\"inbound\", \"outbound\"];\r\n\r\n    let finalGraphOutward = new Graph({ multi });\r\n    let finalGraphInward = new Graph({ multi });\r\n\r\n    for (const reverseGraph of [true, false]) {\r\n      // for (const reverseGraph of [false]) {\r\n      const finalGraphDirections: Record<string, Graph> =\r\n        mapArrayOfKeysToObject(directions, () => new Graph({ multi }));\r\n\r\n      for (const direction of directions) {\r\n        const lineGraphObjectInDirection =\r\n          await getLineGraphObjectFromLineIdList(\r\n            nearbyLineIdList,\r\n            [direction],\r\n            reverseGraph,\r\n            false,\r\n          );\r\n\r\n        finalGraphDirections[direction] = new Graph({ multi });\r\n\r\n        for (const modeName in nearbyStopPointsOnLines) {\r\n          for (const lineId in nearbyStopPointsOnLines[modeName]) {\r\n            const stopPointsReachableFromNearbyStopPointsOnLineGraph =\r\n              new Graph({ multi });\r\n            const graphDirectionLine = lineGraphObjectInDirection[lineId];\r\n            for (const stopPoint of nearbyStopPointsOnLines[modeName][lineId]) {\r\n              // console.log(\r\n              //   `Graphing line \"${lineName}\" stop \"${stopPoint.commonName}\" (${stopPoint.stationNaptan}) in direction \"${direction}\" (reverseGraph=${reverseGraph})`,\r\n              // );\r\n              if (graphDirectionLine.hasNode(stopPoint.stationNaptan)) {\r\n                dfsFromNode(\r\n                  graphDirectionLine,\r\n                  stopPoint.stationNaptan,\r\n                  (node, attr) => {\r\n                    mergeStopPoint(\r\n                      stopPointsReachableFromNearbyStopPointsOnLineGraph,\r\n                      attr as MatchedStop,\r\n                      lineId,\r\n                    );\r\n                  },\r\n                );\r\n              } else {\r\n                // console.log(\"Not found\");\r\n              }\r\n            }\r\n            // let sub = graphDirectionLine;\r\n            // sub = makeLineGraphUndirected(sub);\r\n            const sub = subgraph(\r\n              graphDirectionLine,\r\n              stopPointsReachableFromNearbyStopPointsOnLineGraph.nodes(),\r\n            );\r\n            // for (const stopPoint of nearbyStopPointsOnLines[modeName][\r\n            //   lineId\r\n            // ]) {\r\n            //   sub.mergeNode(stopPoint.stationNaptan, {\r\n            //     size: GRAPH_NODE_SIZE_POI,\r\n            //   });\r\n            // }\r\n            mergeGraph(sub, finalGraphDirections[direction]);\r\n          }\r\n        }\r\n      }\r\n      let finalGraphMerged = mergeGraphObject(finalGraphDirections);\r\n      if (reverseGraph) {\r\n        finalGraphMerged = reverse(finalGraphMerged);\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        finalGraphInward = finalGraphMerged;\r\n      } else {\r\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n        finalGraphOutward = finalGraphMerged;\r\n      }\r\n    }\r\n    const _displayedGraph = finalGraphOutward;\r\n\r\n    setDisplayedGraph(_displayedGraph.copy()); // changes input for some reason, so pass a copy\r\n    setGraphSerialized(makeLineGraphUndirected(_displayedGraph).export());\r\n    toast.success(_info, { id: toastId });\r\n  };\r\n\r\n  const SearchButton = useCallback(\r\n    () => (\r\n      <div>\r\n        <Button\r\n          variant=\"contained\"\r\n          color=\"primary\"\r\n          type=\"submit\"\r\n          // onClick={handleButtonClick}\r\n          disabled={\r\n            formData[\"destination-radius\"] <= 0 ||\r\n            !formData[\"destination-postcode\"]\r\n          }\r\n        >\r\n          Get Data\r\n        </Button>\r\n      </div>\r\n    ),\r\n    [],\r\n  );\r\n  // const handleFormUpdate = (e) => {};\r\n  if (isBusy) return null;\r\n  return (\r\n    <Container maxWidth=\"md\" className=\"App\">\r\n      <Paper>\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n          transit-tool\r\n        </Typography>\r\n        <ModeCheckList\r\n          stateGetter={getModeCheckList}\r\n          stateSetter={setModeCheckList}\r\n        />\r\n        <Grid\r\n          container\r\n          elevation={2}\r\n          sx={{ \"& .MuiTextField-root\": { m: 1, width: \"25ch\" } }}\r\n          alignItems=\"center\"\r\n        >\r\n          <Grid\r\n            item\r\n            xs={12}\r\n            sm={6}\r\n            component=\"form\"\r\n            onSubmit={handleButtonClick}\r\n          >\r\n            <Typography variant=\"h5\">Search</Typography>\r\n            <TextInputCustom\r\n              name=\"destination-postcode\"\r\n              label=\"Commute Destination Postcode\"\r\n              dataObject={formData}\r\n              handleFormChange={handleFormChange}\r\n              error={!formData[\"destination-postcode\"]}\r\n            />\r\n            <NumInputCustom\r\n              name=\"destination-radius\"\r\n              label=\"Commute Destination Search Radius\"\r\n              dataObject={formData}\r\n              handleNumChange={handleNumChange}\r\n              adornment={{ type: \"end\", text: \"m\" }}\r\n              error={formData[\"destination-radius\"] <= 0}\r\n            />\r\n            <SearchButton />\r\n          </Grid>\r\n          <Grid\r\n            item\r\n            // sx={{ m: 2 }}\r\n            xs={12}\r\n            sm={6}\r\n          >\r\n            <Typography variant=\"h5\">Filters</Typography>\r\n            <NumInputCustom\r\n              name=\"min-bedrooms\"\r\n              label=\"Min. Bedrooms\"\r\n              dataObject={filterData}\r\n              handleNumChange={handleNumChange}\r\n              adornment={{ type: \"end\", text: \"beds\" }}\r\n            />\r\n            <NumInputCustom\r\n              name=\"max-bedrooms\"\r\n              label=\"Max. Bedrooms\"\r\n              dataObject={filterData}\r\n              handleNumChange={handleNumChange}\r\n              adornment={{ type: \"end\", text: \"beds\" }}\r\n            />\r\n            <NumInputCustom\r\n              name=\"max-price\"\r\n              label=\"Max. Price\"\r\n              dataObject={filterData}\r\n              handleNumChange={handleNumChange}\r\n              adornment={{ type: \"start\", text: \"\" }}\r\n            />\r\n            <NumInputCustom\r\n              float\r\n              id=\"input-home-radius\"\r\n              name=\"home-radius\"\r\n              label=\"Home Station Search Radius\"\r\n              variant=\"outlined\"\r\n              dataObject={filterData}\r\n              handleNumChange={handleNumChange}\r\n              adornment={{ type: \"end\", text: \"miles\" }}\r\n            />\r\n          </Grid>\r\n        </Grid>\r\n        <p>{info}</p>\r\n        {/* <p>{JSON.stringify(formData)}</p>\r\n        <p>{JSON.stringify(filterData)}</p> */}\r\n        <Map\r\n          originInfo={originInfo}\r\n          nearbyStopPoints={nearbyStopPoints}\r\n          graphSerialized={graphSerialized}\r\n          // filterData={filterData}\r\n        />\r\n        {/* <GraphComponent graph={displayedGraph} style={{}} /> */}\r\n        <p style={{ fontSize: 10 }}>\r\n          <a\r\n            style={{ fontSize: 12 }}\r\n            href=\"https://github.com/qwrwed/accomodation-transit-tool\"\r\n          >\r\n            Source Code\r\n          </a>\r\n          <br />\r\n          Powered by TfL Open Data\r\n          <br />\r\n          Contains OS data  Crown copyright and database rights (2016) and\r\n          Geomni UK Map data  and database rights (2019)\r\n        </p>\r\n      </Paper>\r\n      <Toaster />\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default App;\r\n","import { red } from \"@mui/material/colors\";\r\nimport { createTheme } from \"@mui/material/styles\";\r\n// A custom theme for this app\r\nconst theme = createTheme({\r\n  palette: {\r\n    mode: \"dark\",\r\n    primary: {\r\n      main: \"#61dafb\",\r\n      light: \"#61dafb\",\r\n      dark: \"#21a1c4\",\r\n    },\r\n    secondary: {\r\n      main: \"#b5ecfb\",\r\n      light: \"#61dafb\",\r\n      dark: \"#21a1c4\",\r\n    },\r\n    error: { main: red.A400 },\r\n    background: { default: \"#282c34\" },\r\n  },\r\n  components: {\r\n    MuiPaper: {\r\n      styleOverrides: {\r\n        root: {\r\n          padding: \"20px 10px\",\r\n          margin: \"10px\",\r\n          // backgroundColor: \"#fff\", // 5d737e\r\n        },\r\n      },\r\n    },\r\n    MuiButton: { styleOverrides: { root: { margin: \"5px\" } } },\r\n  },\r\n});\r\nexport default theme;\r\n","/* eslint-disable */\r\nconst reportWebVitals = (onPerfEntry) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import(\"web-vitals\").then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"./index.css\";\r\nimport CssBaseline from \"@mui/material/CssBaseline\";\r\nimport { ThemeProvider } from \"@mui/material/styles\";\r\nimport App from \"./components/App/App\";\r\n// import App from \"./components/test\";\r\n// import App from \"./components/GraphScreen/GraphScreen\";\r\n// import App from \"./components/CheckBoxTreeView\";\r\nimport theme from \"./theme\";\r\n\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport { MapProvider } from \"./components/Map/MapContext\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <ThemeProvider theme={theme}>\r\n      <MapProvider>\r\n        <CssBaseline />\r\n        <App />\r\n      </MapProvider>\r\n    </ThemeProvider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\"),\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}